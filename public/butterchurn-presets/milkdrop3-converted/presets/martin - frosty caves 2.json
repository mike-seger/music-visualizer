{"version":2,"baseVals":{"rating":4,"gammaadj":1.98,"decay":0.5,"echo_zoom":1,"echo_alpha":0.5,"echo_orient":3,"wave_mode":7,"additivewave":1,"wave_thick":1,"modwavealphabyvolume":1,"wave_brighten":0,"wrap":0,"darken":1,"wave_a":0.001,"wave_scale":0.958,"wave_smoothing":0.45,"modwavealphastart":0,"modwavealphaend":1.32,"warpanimspeed":1.459,"warpscale":2.007,"zoom":0.9999,"warp":0.01,"sx":0.9999,"wave_r":0,"wave_g":0,"wave_b":0,"ob_size":0,"ob_g":0.1,"ob_b":1,"ob_a":1,"ib_size":0,"ib_r":0,"ib_g":0,"ib_b":0,"mv_x":25.6,"mv_y":9.6,"mv_l":5,"mv_g":0.5,"mv_a":0,"b1ed":0},"shapes":[{"baseVals":{"textured":1,"x":0.09,"y":0.9,"rad":0.22437,"tex_zoom":1.76002,"r2":1,"g2":0,"a2":0.6,"border_a":0,"enabled":0},"init_eqs_str":"","frame_eqs_str":"","init_eqs_eel":"","frame_eqs_eel":""},{"baseVals":{"sides":100,"additive":1,"x":0.26,"y":0.2,"rad":0.39317,"tex_zoom":6.19589,"r":0,"g":0.55,"b":0.5,"g2":0.4,"b2":0.4,"a2":0.07,"border_r":0.3,"border_g":0.7,"border_b":0.8,"border_a":0,"enabled":0},"init_eqs_str":"","frame_eqs_str":"","init_eqs_eel":"","frame_eqs_eel":""},{"baseVals":{"additive":1,"x":0.803,"rad":0.314,"tex_zoom":1.49332,"g":1,"b":1,"a":0,"g2":0,"border_r":0.5,"border_g":0.5,"border_b":0.5,"border_a":1,"enabled":0},"init_eqs_str":"","frame_eqs_str":"","init_eqs_eel":"","frame_eqs_eel":""},{"baseVals":{"sides":100,"rad":0.01,"tex_zoom":0.49981,"r":0,"g2":0,"border_r":0.2,"border_g":0.7,"border_b":0.5,"border_a":0,"enabled":0},"init_eqs_str":"","frame_eqs_str":"","init_eqs_eel":"","frame_eqs_eel":""}],"waves":[{"baseVals":{"samples":132,"sep":20,"thick":1,"additive":1,"scaling":0.48454,"smoothing":0.1,"g":0,"b":0.2,"enabled":0},"init_eqs_str":"","frame_eqs_str":"","point_eqs_str":"","init_eqs_eel":"","frame_eqs_eel":"","point_eqs_eel":""},{"baseVals":{"usedots":1,"thick":1,"scaling":0.89152,"smoothing":0.82,"a":0.1,"enabled":0},"init_eqs_str":"","frame_eqs_str":"","point_eqs_str":"","init_eqs_eel":"","frame_eqs_eel":"","point_eqs_eel":""},{"baseVals":{"thick":1,"scaling":0.89152,"smoothing":0.82,"r":0,"g":0.2,"b":0,"enabled":0},"init_eqs_str":"","frame_eqs_str":"","point_eqs_str":"","init_eqs_eel":"","frame_eqs_eel":"","point_eqs_eel":""},{"baseVals":{"spectrum":1,"usedots":1,"enabled":0},"init_eqs_str":"","frame_eqs_str":"","point_eqs_str":"","init_eqs_eel":"","frame_eqs_eel":"","point_eqs_eel":""}],"init_eqs_str":"(function(){a['n'] = 0; a['maxbpm'] = 0; a['reg26'] = 0; a['maxind1'] = 0; a['uvx0'] = 0; a['cosb_'] = 0; a['reg34'] = 0; a['num_res'] = 0; a['reg28'] = 0; a['reg23'] = 0; a['q25'] = 0; a['angchg'] = 0; a['reg20'] = 0; a['reg15'] = 0; a['reg10'] = 0; a['sinb_'] = 0; a['index'] = 0; a['quali'] = 0; a['q12'] = 0; a['v3'] = 0; a['q18'] = 0; a['q22'] = 0; a['q21'] = 0; a['diry'] = 0; a['q13'] = 0; a['q6'] = 0; a['posx'] = 0; a['fps_'] = 0; a['dt'] = 0; a['reg25'] = 0; a['mean'] = 0; a['uvx'] = 0; a['q1'] = 0; a['posz'] = 0; a['q5'] = 0; a['dt1'] = 0; a['dec_f'] = 0; a['dirz'] = 0; a['dec_s'] = 0; a['reg16'] = 0; a['bt2'] = 0; a['reg36'] = 0; a['minbpm'] = 0; a['reg22'] = 0; a['uvy'] = 0; a['rotz'] = 0; a['cosb'] = 0; a['omega'] = 0; a['nomov'] = 0; a['dist_'] = 0; a['ec_steps'] = 0; a['bpm'] = 0; a['q23'] = 0; a['q24'] = 0; a['reg24'] = 0; a['ran2'] = 0; a['q11'] = 0; a['pi'] = 0; a['q10'] = 0; a['reg14'] = 0; a['sinb'] = 0; a['posy'] = 0; a['reg31'] = 0; a['dirx'] = 0; a['dec_m'] = 0; a['q4'] = 0; a['start'] = 0; a['reg12'] = 0; a['reg13'] = 0; a['v2p'] = 0; a['c2'] = 0; a['reg37'] = 0; a['ex'] = 0; a['s3'] = 0; a['yslope'] = 0; a['q16'] = 0; a['xslope'] = 0; a['q26'] = 0; a['reg38'] = 0; a['v3p'] = 0; a['reg35'] = 0; a['mov'] = 0; a['reg11'] = 0; a['tx'] = 0; a['avg'] = 0; a['bt1'] = 0; a['beatsin'] = 0; a['uvz'] = 0; a['c3'] = 0; a['uvy0'] = 0; a['reg27'] = 0; a['q19'] = 0; a['q17'] = 0; a['vol'] = 0; a['reg32'] = 0; a['reg21'] = 0; a['uvz0'] = 0; a['len'] = 0; a['reg18'] = 0; a['beatcos'] = 0; a['reg30'] = 0; a['q2'] = 0; a['b1y'] = 0; a['q27'] = 0; a['bri'] = 0; a['slen'] = 0; a['q14'] = 0; a['dist'] = 0; a['trel1'] = 0; a['reg17'] = 0; a['v1'] = 0; a['speed'] = 0; a['vol2'] = 0; a['q3'] = 0; a['s1'] = 0; a['vol_'] = 0; a['dec'] = 0; a['s2'] = 0; a['quad'] = 0; a['b2y'] = 0; a['ran1'] = 0; a['q32'] = 0; a['reg33'] = 0; a['q7'] = 0; a['ds'] = 0; a['q28'] = 0; a['ty'] = 0; a['excite'] = 0; a['c1'] = 0; a['v2'] = 0; a['q20'] = 0; a['q8'] = 0; a['maxvol'] = 0; a['n']=0; for(var mdparser_idx413=0;mdparser_idx413<20000;mdparser_idx413++){a['megabuf'][Math.floor(a['n'])]=0; a['gmegabuf'][Math.floor(a['n'])]=0; a['n']+=1;} a['minbpm']=30; a['maxbpm']=220; a['num_res']=100; a['index']=0; for(var mdparser_idx414=0;mdparser_idx414<a['num_res'];mdparser_idx414++){a['n']=(12*a['index']); a['bpm']=(a['minbpm']*pow(div(a['maxbpm'],a['minbpm']), div(a['index'],a['num_res']))); a['gmegabuf'][Math.floor(a['n'])]=a['bpm']; a['index']+=1;} a['pi']=3.1416; a['octave']=div((a['num_res']*Math.log(2)),Math.log(div(a['maxbpm'],a['minbpm']))); a['q7']=0.15; a['q8']=(rand(2)-0.25); a['q16']=1.8; a['start']=1; a['travel']=0; a['rotz']=0; a['t0']=(a['time']+3); a['cran0']=rand(1); a['trelx']=0; a['trely']=0; a['trelz']=0; a['reg20']=1; a['reg21']=0; a['reg22']=0; a['reg23']=0; a['reg24']=1; a['reg25']=0; a['reg26']=0; a['reg27']=0; a['reg28']=1; (function(){var mdparser_idx415;var mdparser_count416=0;do{mdparser_count416+=1;mdparser_idx415=(function(){a['ran1']=rand(8); a['ran2']=rand(8); a['ran3']=rand(8); a['posx']=rand(8); a['posy']=rand(8); a['posz']=rand(8); a['c1']=Math.cos(a['ran1']); a['c2']=Math.cos(a['ran2']); a['c3']=Math.cos(a['ran3']); a['s1']=Math.sin(a['ran1']); a['s2']=Math.sin(a['ran2']); a['s3']=Math.sin(a['ran3']); a['reg20']=(a['c2']*a['c1']); a['reg21']=(a['c2']*a['s1']); a['reg22']=-a['s2']; a['reg23']=(((a['s3']*a['s2'])*a['c1'])-(a['c3']*a['s1'])); a['reg24']=(((a['s3']*a['s2'])*a['s1'])+(a['c3']*a['c1'])); a['reg25']=(a['s3']*a['c2']); a['reg26']=(((a['c3']*a['s2'])*a['c1'])+(a['s3']*a['s1'])); a['reg27']=(((a['c3']*a['s2'])*a['s1'])-(a['s3']*a['c1'])); a['reg28']=(a['c3']*a['c2']); a['dist']=0.001; (function(){var mdparser_idx417;var mdparser_count418=0;do{mdparser_count418+=1;mdparser_idx417=(function(){a['uvx']=div((a['reg26']*a['dist']),a['q7']); a['uvy']=div((a['reg27']*a['dist']),a['q7']); a['uvz']=div((a['reg28']*a['dist']),a['q7']); a['uvx']+=a['posx']; a['uvy']+=a['posy']; a['uvz']+=a['posz']; a['uvx']=(1+(2*(((div(a['uvx'],4)+30.5)-Math.floor((div(a['uvx'],4)+30.5)))-0.5))); a['uvy']=(2+(2*(((div(a['uvy'],4)+30.5)-Math.floor((div(a['uvy'],4)+30.5)))-0.5))); a['uvz']=(3+(2*(((div(a['uvz'],4)+30.5)-Math.floor((div(a['uvz'],4)+30.5)))-0.5))); a['uvx0']=(a['uvx']+a['q8']); a['uvy0']=(a['uvy']+a['q8']); a['uvz0']=(a['uvz']+a['q8']); for(var mdparser_idx419=0;mdparser_idx419<(7+1);mdparser_idx419++){a['uvx']=((Math.abs(((a['uvx']>1)?1:0))>0.00001)?((2-a['uvx'])):(((Math.abs(((a['uvx']<-1)?1:0))>0.00001)?((-2-a['uvx'])):(a['uvx'])))); a['uvy']=((Math.abs(((a['uvy']>1)?1:0))>0.00001)?((2-a['uvy'])):(((Math.abs(((a['uvy']<-1)?1:0))>0.00001)?((-2-a['uvy'])):(a['uvy'])))); a['uvz']=((Math.abs(((a['uvz']>1)?1:0))>0.00001)?((2-a['uvz'])):(((Math.abs(((a['uvz']<-1)?1:0))>0.00001)?((-2-a['uvz'])):(a['uvz'])))); a['slen']=(((a['uvx']*a['uvx'])+(a['uvy']*a['uvy']))+(a['uvz']*a['uvz'])); a['uvx']=((((Math.abs(((a['slen']<0.25)?1:0))>0.00001)?((a['uvx']*4)):(((Math.abs(((a['slen']<1)?1:0))>0.00001)?(div(a['uvx'],a['slen'])):(a['uvx']))))*2.6)+a['uvx0']); a['uvy']=((((Math.abs(((a['slen']<0.25)?1:0))>0.00001)?((a['uvy']*4)):(((Math.abs(((a['slen']<1)?1:0))>0.00001)?(div(a['uvy'],a['slen'])):(a['uvy']))))*2.6)+a['uvy0']); a['uvz']=((((Math.abs(((a['slen']<0.25)?1:0))>0.00001)?((a['uvz']*4)):(((Math.abs(((a['slen']<1)?1:0))>0.00001)?(div(a['uvz'],a['slen'])):(a['uvz']))))*2.6)+a['uvz0']);} a['len']=sqrt((((a['uvx']*a['uvx'])+(a['uvy']*a['uvy']))+(a['uvz']*a['uvz']))); a['dist']*=1.05; return (((a['dist']<0.6)?1:0)*((a['len']>30)?1:0))})()}while(Math.abs(mdparser_idx417)>0.000010&&mdparser_count418<1048576);}()); return ((a['dist']<0.06)?1:0)})()}while(Math.abs(mdparser_idx415)>0.000010&&mdparser_count416<1048576);}());}())","frame_eqs_str":"(function(){a['dt']=Math.min(div(1,a['fps']), 0.1); a['fps_']=div(1,a['dt']); a['dec_f']=0.8; a['dec_m']=(1-(4*a['dt'])); a['dec_s']=(1-a['dt']); a['vol']=div(((a['bass']+div(a['mid'],2))+a['treb']),3); a['vol_']=((a['vol_']*a['dec_m'])+((1-a['dec_m'])*a['vol'])); a['dec']=a['dec_s']; a['vol2']=((a['vol2']*a['dec'])+((1-a['dec'])*Math.min(3, a['vol']))); a['maxvol']=((Math.abs(((a['vol']>a['maxvol'])?1:0))>0.00001)?(a['vol']):((a['maxvol']*a['dec_s']))); a['excite']=(a['vol']-a['vol_']); a['index']=0; a['maxind1']=0; a['mean']=0; for(var mdparser_idx420=0;mdparser_idx420<a['num_res'];mdparser_idx420++){a['n']=(a['index']*12); a['omega']=div(((a['gmegabuf'][Math.floor(a['n'])]*2)*a['pi']),60); a['gmegabuf'][Math.floor((a['n']+1))]*=(1-(0.25*a['dt'])); a['ec_steps']=(Math.floor(((10*a['dt'])*a['omega']))+1); a['dt1']=div(a['dt'],a['ec_steps']); a['ex']=a['excite']; for(var mdparser_idx421=0;mdparser_idx421<a['ec_steps'];mdparser_idx421++){a['gmegabuf'][Math.floor((a['n']+1))]+=((a['ex']-(sqr(a['omega'])*a['gmegabuf'][Math.floor((a['n']+2))]))*a['dt1']); a['gmegabuf'][Math.floor((a['n']+2))]+=(a['gmegabuf'][Math.floor((a['n']+1))]*a['dt1']);} a['beatcos']=a['gmegabuf'][Math.floor((a['n']+1))]; a['beatsin']=(a['gmegabuf'][Math.floor((a['n']+2))]*a['omega']); a['quad']=sqrt((pow(a['beatsin'], 2)+pow(a['beatcos'], 2))); a['mean']+=div(a['quad'],a['num_res']); a['gmegabuf'][Math.floor((a['n']+3))]=((a['gmegabuf'][Math.floor((a['n']+3))]*a['dec_m'])+(a['quad']*(1-a['dec_m']))); ((Math.abs(((a['gmegabuf'][Math.floor((a['n']+3))]>a['gmegabuf'][Math.floor(((a['maxind1']*12)+3))])?1:0))>0.00001)?(a['maxind1']=a['index']):(0)); a['index']+=1;} a['quali']=div(a['gmegabuf'][Math.floor(((a['maxind1']*12)+3))],a['mean']); a['bpm']=(a['minbpm']*pow(div(a['maxbpm'],a['minbpm']), div(a['maxind1'],a['num_res']))); ((Math.abs(((a['bpm']>160)?1:0))>0.00001)?(a['bpm']/=2):(0)); a['trel1']+=((((div(a['bpm'],60)*a['pi'])+(((a['excite']*a['cosb'])*a['cosb'])*4))*((a['maxvol']>0.7)?1:0))*a['dt']); a['q32']=a['trel1']; a['speed']=(div(((0.05+(a['dist_']*0.4))*(1+a['avg'])),a['q7'])*(0.4+a['vol_'])); a['ds']=((a['ds']*a['dec_s'])+div((((1-a['dec_s'])*a['speed'])*0.25),a['fps_'])); a['rotz']=(0.2*pow(Math.sin(div(a['time'],8)), 3)); a['dirx']=a['reg26']; a['diry']=a['reg27']; a['dirz']=a['reg28']; a['posx']=(a['posx']+(a['ds']*a['dirx'])); a['posy']=(a['posy']+(a['ds']*a['diry'])); a['posz']=(a['posz']+(a['ds']*a['dirz'])); a['q4']=a['posx']; a['q5']=a['posy']; a['q6']=a['posz']; a['angchg']=(((0.3-a['dist_'])*((a['dist_']<0.3)?1:0))*3); a['v1']=((a['v1']*a['dec_m'])+(((1-a['dec_m'])*a['rotz'])*a['ds'])); a['v2p']=((a['v2p']*a['dec_m'])+div((((1-a['dec_m'])*a['angchg'])*a['xslope']),a['fps'])); a['v3p']=((a['v3p']*a['dec_m'])+((1-a['dec_m'])*div((a['angchg']*a['yslope']),a['fps']))); a['v2']=((a['v2']*a['dec_m'])+((1-a['dec_m'])*a['v2p'])); a['v3']=((a['v3']*a['dec_m'])+((1-a['dec_m'])*a['v3p'])); a['reg30']=a['reg20']; a['reg31']=a['reg21']; a['reg32']=a['reg22']; a['reg33']=a['reg23']; a['reg34']=a['reg24']; a['reg35']=a['reg25']; a['reg36']=a['reg26']; a['reg37']=a['reg27']; a['reg38']=a['reg28']; a['n']=0; a['avg']=0; for(var mdparser_idx422=0;mdparser_idx422<5;mdparser_idx422++){a['n']=(a['n']+1); a['ran1']=div(rand(100),100); a['ran2']=(div(rand(100),200)-0.25); a['tx']=((Math.cos(((a['n']*1.57)+a['ran2']))*((a['n']<=4)?1:0))*a['ran1']); a['ty']=((Math.sin(((a['n']*1.57)+a['ran2']))*((a['n']<=4)?1:0))*a['ran1']); a['c1']=Math.cos(a['v1']); a['c2']=Math.cos((a['v2']+a['ty'])); a['c3']=Math.cos((a['v3']+a['tx'])); a['s1']=Math.sin(a['v1']); a['s2']=Math.sin((a['v2']+a['ty'])); a['s3']=Math.sin((a['v3']+a['tx'])); a['reg10']=(a['c2']*a['c1']); a['reg11']=(a['c2']*a['s1']); a['reg12']=-a['s2']; a['reg13']=(((a['s3']*a['s2'])*a['c1'])-(a['c3']*a['s1'])); a['reg14']=(((a['s3']*a['s2'])*a['s1'])+(a['c3']*a['c1'])); a['reg15']=(a['s3']*a['c2']); a['reg16']=(((a['c3']*a['s2'])*a['c1'])+(a['s3']*a['s1'])); a['reg17']=(((a['c3']*a['s2'])*a['s1'])-(a['s3']*a['c1'])); a['reg18']=(a['c3']*a['c2']); a['reg20']=a['reg30']; a['reg21']=a['reg31']; a['reg22']=a['reg32']; a['reg23']=a['reg33']; a['reg24']=a['reg34']; a['reg25']=a['reg35']; a['reg26']=a['reg36']; a['reg27']=a['reg37']; a['reg28']=a['reg38']; a['q20']=(((a['reg10']*a['reg20'])+(a['reg11']*a['reg23']))+(a['reg12']*a['reg26'])); a['q21']=(((a['reg10']*a['reg21'])+(a['reg11']*a['reg24']))+(a['reg12']*a['reg27'])); a['q22']=(((a['reg10']*a['reg22'])+(a['reg11']*a['reg25']))+(a['reg12']*a['reg28'])); a['q23']=(((a['reg13']*a['reg20'])+(a['reg14']*a['reg23']))+(a['reg15']*a['reg26'])); a['q24']=(((a['reg13']*a['reg21'])+(a['reg14']*a['reg24']))+(a['reg15']*a['reg27'])); a['q25']=(((a['reg13']*a['reg22'])+(a['reg14']*a['reg25']))+(a['reg15']*a['reg28'])); a['q26']=(((a['reg16']*a['reg20'])+(a['reg17']*a['reg23']))+(a['reg18']*a['reg26'])); a['q27']=(((a['reg16']*a['reg21'])+(a['reg17']*a['reg24']))+(a['reg18']*a['reg27'])); a['q28']=(((a['reg16']*a['reg22'])+(a['reg17']*a['reg25']))+(a['reg18']*a['reg28'])); a['reg20']=a['q20']; a['reg21']=a['q21']; a['reg22']=a['q22']; a['reg23']=a['q23']; a['reg24']=a['q24']; a['reg25']=a['q25']; a['reg26']=a['q26']; a['reg27']=a['q27']; a['reg28']=a['q28']; a['dist']=0.002; (function(){var mdparser_idx423;var mdparser_count424=0;do{mdparser_count424+=1;mdparser_idx423=(function(){a['uvx']=div((a['reg26']*a['dist']),a['q7']); a['uvy']=div((a['reg27']*a['dist']),a['q7']); a['uvz']=div((a['reg28']*a['dist']),a['q7']); a['uvx']+=a['posx']; a['uvy']+=a['posy']; a['uvz']+=a['posz']; a['uvx']=(1+(2*(((div(a['uvx'],4)+30.5)-Math.floor((div(a['uvx'],4)+30.5)))-0.5))); a['uvy']=(2+(2*(((div(a['uvy'],4)+30.5)-Math.floor((div(a['uvy'],4)+30.5)))-0.5))); a['uvz']=(3+(2*(((div(a['uvz'],4)+30.5)-Math.floor((div(a['uvz'],4)+30.5)))-0.5))); a['uvx0']=(a['uvx']+a['q8']); a['uvy0']=(a['uvy']+a['q8']); a['uvz0']=(a['uvz']+a['q8']); for(var mdparser_idx425=0;mdparser_idx425<(7+1);mdparser_idx425++){a['uvx']=((Math.abs(((a['uvx']>1)?1:0))>0.00001)?((2-a['uvx'])):(((Math.abs(((a['uvx']<-1)?1:0))>0.00001)?((-2-a['uvx'])):(a['uvx'])))); a['uvy']=((Math.abs(((a['uvy']>1)?1:0))>0.00001)?((2-a['uvy'])):(((Math.abs(((a['uvy']<-1)?1:0))>0.00001)?((-2-a['uvy'])):(a['uvy'])))); a['uvz']=((Math.abs(((a['uvz']>1)?1:0))>0.00001)?((2-a['uvz'])):(((Math.abs(((a['uvz']<-1)?1:0))>0.00001)?((-2-a['uvz'])):(a['uvz'])))); a['slen']=(((a['uvx']*a['uvx'])+(a['uvy']*a['uvy']))+(a['uvz']*a['uvz'])); a['uvx']=((((Math.abs(((a['slen']<0.25)?1:0))>0.00001)?((a['uvx']*4)):(((Math.abs(((a['slen']<1)?1:0))>0.00001)?(div(a['uvx'],a['slen'])):(a['uvx']))))*2.6)+a['uvx0']); a['uvy']=((((Math.abs(((a['slen']<0.25)?1:0))>0.00001)?((a['uvy']*4)):(((Math.abs(((a['slen']<1)?1:0))>0.00001)?(div(a['uvy'],a['slen'])):(a['uvy']))))*2.6)+a['uvy0']); a['uvz']=((((Math.abs(((a['slen']<0.25)?1:0))>0.00001)?((a['uvz']*4)):(((Math.abs(((a['slen']<1)?1:0))>0.00001)?(div(a['uvz'],a['slen'])):(a['uvz']))))*2.6)+a['uvz0']);} a['len']=sqrt((((a['uvx']*a['uvx'])+(a['uvy']*a['uvy']))+(a['uvz']*a['uvz']))); a['dist']*=1.1; return (((a['dist']<0.6)?1:0)*((a['len']>30)?1:0))})()}while(Math.abs(mdparser_idx423)>0.000010&&mdparser_count424<1048576);}()); a['megabuf'][Math.floor(a['n'])]=((a['megabuf'][Math.floor(a['n'])]*a['dec_s'])+((1-a['dec_s'])*a['dist'])); a['avg']=(a['avg']+Math.abs(div(a['megabuf'][Math.floor(a['n'])],5)));} a['n']=0; a['avg']=0; for(var mdparser_idx426=0;mdparser_idx426<5;mdparser_idx426++){a['n']=(a['n']+1); a['avg']=(a['avg']+Math.abs(div(a['megabuf'][Math.floor(a['n'])],5)));} a['xslope']=Math.min(Math.max((8*(a['megabuf'][Math.floor(1)]-a['megabuf'][Math.floor(3)])), -2), 2); a['yslope']=Math.min(Math.max((8*(a['megabuf'][Math.floor(4)]-a['megabuf'][Math.floor(2)])), -2), 2); a['dist_']=((a['dist_']*a['dec_s'])+((1-a['dec_s'])*a['dist'])); a['q10']=(a['ds']*a['q7']); a['q14']=((((1*Math.abs(a['ds']))+(2*((Math.abs(a['v1'])+Math.abs(a['v2']))+Math.abs(a['v3']))))+div(1.0,255))+(a['start']*0.05)); a['start']=(a['start']*0.9); a['q11']=a['v1']; a['q12']=-a['v2']; a['q13']=a['v3']; a['warp']=0.0; a['zoom']=1; a['dx']=div(a['q12'],a['q16']); a['dy']=div(a['q13'],a['q16']); a['rot']=a['q11']; a['sinb']=Math.sin(a['trel1']); a['cosb']=Math.cos(a['trel1']); a['bt1']=(((a['sinb']*a['sinb_'])<0)?1:0); a['bt2']=(((a['cosb']*a['cosb_'])<0)?1:0); ((Math.abs(a['bt1'])>0.00001)?((function(){a['b1x']=(rand(2)-1); return a['b1y']=(rand(2)-1);})()):(0)); ((Math.abs(a['bt2'])>0.00001)?((function(){a['b2x']=(rand(2)-1); return a['b2y']=(rand(2)-1);})()):(0)); a['sinb_']=a['sinb']; a['cosb_']=a['cosb']; a['bri']=((a['vol2']*0.02)+(a['excite']*0.015)); a['q1']=(a['b1x']*0.5); a['q2']=(a['b1y']*0.5); a['mov']=div(sqrt(((a['v3']*a['v3'])+(a['v2']*a['v2']))),a['dt']); a['monitor']=a['nomov']; a['q17']=(a['b2x']*0.5); a['q18']=(a['b2y']*0.5); a['q3']=((pow(a['sinb'], 2)*a['bri'])*Math.max(0, (1-(10*a['mov'])))); a['q19']=((pow(a['cosb'], 2)*a['bri'])*1); a['monitor']=a['vol2'];}())","pixel_eqs_str":"(function(){a['warp']=0.0; a['zoom']=1; a['tx']=Math.tan((((2*a['x'])-1)*0.9)); a['ty']=Math.tan((((2*a['y'])-1)*0.9)); a['dx']=(div(a['q12'],a['q16'])*(1+(0.5*Math.abs(a['tx'])))); a['dy']=(div(a['q13'],a['q16'])*(1+(0.5*Math.abs(a['ty'])))); a['dx']+=(((a['q13']*a['ty'])*(a['x']-0.5))*1); a['dy']+=(((a['q12']*a['tx'])*(a['y']-0.5))*1);}())","init_eqs_eel":"n = 0; loop (20000, megabuf(n)=0; gmegabuf(n)=0; n +=1; );\n\nMINBPM = 30; MAXBPM = 220; num_res = 100;\nindex = 0;\nloop (num_res,\n  n = 12*index;\n  BPM      = minbpm * pow(maxbpm/minbpm,index/num_res);\n  gmegabuf(n) = BPM;\n  index += 1;\n);\npi = 3.1416;\nOCTAVE = (num_res) * log(2) / log (MAXBPM / MINBPM);\n\nq7 = .15; //MyZoom\nq8 =  rand(2)-0.25; //fractal modifier\nq16 = 1.8; //#fish eye\nstart = 1; travel = 0; RotZ = 0; t0 = time+3;\ncran0 = rand(1);\ntrelx = 0;  trely = 0; trelz = 0;\nreg20 = 1; reg21 = 0; reg22 = 0; reg23 = 0; reg24 = 1; reg25 = 0; reg26 = 0; reg27 = 0; reg28 = 1;\n\n//Find random starting point\nwhile (exec2(\n  ran1 = rand(8); ran2 = rand(8); ran3 = rand(8);\n  PosX = rand(8); PosY = rand(8); PosZ = rand(8); \n\n  c1 = cos(ran1); c2 = cos(ran2); c3 = cos(ran3); \n  s1 = sin(ran1); s2 = sin(ran2); s3 = sin(ran3);\n\n  reg20 = c2*c1; reg21 = c2*s1; reg22 = -s2;\n  reg23 = s3*s2*c1 - c3*s1; reg24 = s3*s2*s1 + c3*c1; reg25 = s3*c2;\n  reg26 = c3*s2*c1 + s3*s1; reg27 = c3*s2*s1 - s3*c1; reg28 = c3*c2;\n\n  //***********BOT*************\n  //Coord. Trans. must exactly match def in warp S. !!!!\n  dist = 0.001;\n  while (exec2(\n    uvx = reg26*dist/q7; uvy = reg27*dist/q7; uvz = reg28*dist/q7;\n    uvx += PosX; uvy += PosY; uvz += PosZ;\n    uvx = 1+2*((uvx/4+30.5 - int(uvx/4+30.5))-.5);\n    uvy = 2+2*((uvy/4+30.5 - int(uvy/4+30.5))-.5);\n    uvz = 3+2*((uvz/4+30.5 - int(uvz/4+30.5))-.5);\n    uvx0 = uvx+q8; uvy0 = uvy+q8; uvz0 = uvz+q8;\n    loop (7+1,\n      uvx = if (uvx > 1, 2-uvx, if(uvx < -1, -2-uvx, uvx));\n      uvy = if (uvy > 1, 2-uvy, if(uvy < -1, -2-uvy, uvy));\n      uvz = if (uvz > 1, 2-uvz, if(uvz < -1, -2-uvz, uvz));\n      slen = uvx*uvx + uvy*uvy + uvz*uvz;\n      uvx = if (slen < 0.25, uvx*4, if (slen < 1, uvx/slen, uvx)) *2.6 + uvx0; \n      uvy = if (slen < 0.25, uvy*4, if (slen < 1, uvy/slen, uvy)) *2.6 + uvy0; \n      uvz = if (slen < 0.25, uvz*4, if (slen < 1, uvz/slen, uvz)) *2.6 + uvz0; \n    );\n    len = sqrt(uvx*uvx + uvy*uvy + uvz*uvz);\n    dist *= 1.05;\n  ,(dist < 0.6)*(len > 30)));\n,(dist < .06))); //end while","frame_eqs_eel":"dt = min (1/fps,0.1) ; fps_ = 1/dt;\ndec_f = 0.8; dec_m = 1 - 4*dt; dec_s = 1 - dt;\nvol = (bass+mid/2+treb)/3;\nvol_ = vol_*dec_m + (1-dec_m)*vol;\ndec = dec_s;\nvol2 = vol2*dec + (1-dec)*min(3,vol);\nmaxvol = if (vol>maxvol,vol,maxvol*dec_s);\n\nexcite = vol-vol_;\nindex = 0; maxind1 = 0; mean = 0;\nloop (num_res, \n  n = index*12;  omega=gmegabuf(n) * 2*pi/60;\n  gmegabuf (n+1) *= 1- 0.25*dt; \n  EC_Steps = int (10*dt*omega)+1; dt1 = dt/EC_Steps;\n  ex = excite ;\n  loop (EC_Steps, // Euler-Cauchy \n    gmegabuf (n+1) += (ex - sqr(omega)*gmegabuf(n+2)) * dt1;\n    gmegabuf (n+2) += gmegabuf(n+1) * dt1);\n  beatcos  = gmegabuf(n+1);  beatsin = gmegabuf(n+2)*omega;\n  quad     = sqrt (pow(beatsin,2) + pow(beatcos,2)) ;\n   mean += quad/num_res;\n  gmegabuf (n+3) = gmegabuf(n+3) *dec_m +  quad* (1-dec_m);\n  if (gmegabuf(n+3) > gmegabuf(maxind1*12+3), maxind1 = index, 0); \nindex += 1;);\nquali = gmegabuf(maxind1*12+3)/mean;\n\nBPM   = minbpm * pow(maxbpm/minbpm,maxind1/num_res);\nif (BPM>160, BPM/=2,0);\ntrel1 += (BPM/60*pi+excite*cosb*cosb*4) * (maxvol>0.7)*dt;\nq32 = trel1;\n\nspeed = (0.05 + dist_*0.4)* (1+avg)/q7*(0.4+vol_);\nds = ds * dec_s + (1-dec_s)*speed*.25/fps_; \nRotZ = 0.2*pow (sin(time/8),3);\n\n//Position \nDirX= reg26; DirY= reg27; DirZ = reg28;\nPosX = PosX + ds*DirX ; PosY = PosY + ds*DirY; PosZ = PosZ + ds*DirZ; \nq4 = PosX; q5 = PosY; q6 = PosZ;\n\nangchg = (.3-dist_)*(dist_ < .3)*3;\nv1 = v1 * dec_m + (1-dec_m)* RotZ * ds;\nv2p = v2p *dec_m + (1-dec_m)* angchg *xslope/fps;\nv3p = v3p *dec_m + (1-dec_m)*(angchg *yslope/fps);\nv2 = v2 *dec_m + (1-dec_m)* v2p;\nv3 = v3 *dec_m + (1-dec_m)* v3p;\n\n\n//push old RotMat\nreg30 =reg20; reg31 =reg21; reg32 =reg22; \nreg33 =reg23; reg34 =reg24; reg35 =reg25; \nreg36 =reg26; reg37 =reg27; reg38 =reg28; \n\nn = 0; avg = 0;\nloop (5,\n  n = n+1;\n  //new Rot. Mat for infinitesimal angles\n  ran1 = rand(100)/100;\n  ran2 = rand(100)/200-.25;\n  tx = cos(n*1.57+ran2) * (n <= 4)*ran1; ty = sin(n*1.57+ran2) * (n <= 4)*ran1;\n  c1 = cos(v1); c2 = cos(v2+ty); c3 = cos(v3+tx); \n  s1 = sin(v1); s2 = sin(v2+ty); s3 = sin(v3+tx);\n  reg10 = c2*c1; reg11 = c2*s1; reg12 = -s2;\n  reg13 = s3*s2*c1 - c3*s1; reg14 = s3*s2*s1 + c3*c1; reg15 = s3*c2;\n  reg16 = c3*s2*c1 + s3*s1; reg17 = c3*s2*s1 - s3*c1; reg18 = c3*c2;\n\n  //pop old RotMat\n  reg20 =reg30; reg21 =reg31; reg22 =reg32; \n  reg23 =reg33; reg24 =reg34; reg25 =reg35; \n  reg26 =reg36; reg27 =reg37; reg28 =reg38; \n\n  //Multiply new RotMat by old one\n  q20 = reg10*reg20 + reg11*reg23 + reg12*reg26;\n  q21 = reg10*reg21 + reg11*reg24 + reg12*reg27;\n  q22 = reg10*reg22 + reg11*reg25 + reg12*reg28;\n  q23 = reg13*reg20 + reg14*reg23 + reg15*reg26;\n  q24 = reg13*reg21 + reg14*reg24 + reg15*reg27;\n  q25 = reg13*reg22 + reg14*reg25 + reg15*reg28;\n  q26 = reg16*reg20 + reg17*reg23 + reg18*reg26;\n  q27 = reg16*reg21 + reg17*reg24 + reg18*reg27;\n  q28 = reg16*reg22 + reg17*reg25 + reg18*reg28;\n\n  reg20 =q20; reg21 =q21; reg22 =q22;\n  reg23 =q23; reg24 =q24; reg25 =q25;\n  reg26 =q26; reg27 =q27; reg28 =q28;\n\n  //***********BOT*************\n  //Coord. Trans. must exactly match def in warp S. !!!!\n  dist = 0.002;\n  while (exec2(\n    uvx = reg26*dist/q7; uvy = reg27*dist/q7; uvz = reg28*dist/q7;\n    uvx += PosX; uvy += PosY; uvz += PosZ;\n//    uvx = 8.0*((uvx/8+30.5 - int(uvx/8+30.5))-.5);\n//    uvy = 8.0*((uvy/8+30.5 - int(uvy/8+30.5))-.5);\n//    uvz = 8.0*((uvz/8+30.5 - int(uvz/8+30.5))-.5);\n    uvx = 1+2*((uvx/4+30.5 - int(uvx/4+30.5))-.5);\n    uvy = 2+2*((uvy/4+30.5 - int(uvy/4+30.5))-.5);\n    uvz = 3+2*((uvz/4+30.5 - int(uvz/4+30.5))-.5);\n    uvx0 = uvx+q8; uvy0 = uvy+q8; uvz0 = uvz+q8;\n    loop (7+1,\n      uvx = if (uvx > 1, 2-uvx, if(uvx < -1, -2-uvx, uvx));\n      uvy = if (uvy > 1, 2-uvy, if(uvy < -1, -2-uvy, uvy));\n      uvz = if (uvz > 1, 2-uvz, if(uvz < -1, -2-uvz, uvz));\n      slen = uvx*uvx + uvy*uvy + uvz*uvz;\n      uvx = if (slen < 0.25, uvx*4, if (slen < 1, uvx/slen, uvx)) *2.6 + uvx0; \n      uvy = if (slen < 0.25, uvy*4, if (slen < 1, uvy/slen, uvy)) *2.6 + uvy0; \n      uvz = if (slen < 0.25, uvz*4, if (slen < 1, uvz/slen, uvz)) *2.6 + uvz0; \n    );\n    len = sqrt(uvx*uvx + uvy*uvy + uvz*uvz);\n    dist *= 1.1;\n  ,(dist < 0.6)*(len > 30)));\n  megabuf(n) = megabuf(n)*dec_s + (1-dec_s)*dist; //stores the 4 trial points\n  avg = avg+abs(megabuf(n)/5);\n); //end loop 5\nn = 0; avg = 0; loop (5, n=n+1; avg = avg+abs(megabuf(n)/5));\n\nxslope = min(max(8*(megabuf(1)-megabuf(3)),-2),2);\nyslope = min(max(8*(megabuf(4)-megabuf(2)),-2),2);\ndist_ = dist_*dec_s + (1-dec_s)*dist;\n\nq10 = ds*q7; //compensation of lin. movement in GetDist and zoom uv\nq14 = 1*abs(ds) + 2*(abs(v1) + abs(v2) + abs(v3)) + 1.0/255 + start*.05; \nstart = start * .9;\nq11 = v1; q12 = -v2; q13 = v3;\n//forward comp. of Rotation\n\nwarp = 0.0; zoom = 1; dx = q12/q16; dy = q13/q16; \nrot =q11;\n\n//BEAT\nsinb = sin(trel1);\ncosb = cos(trel1);\n\nbt1 = sinb*sinb_<0;\nbt2 = cosb*cosb_<0;\n\nif (bt1, b1x = rand(2)-1; b1y = rand(2)-1;,0);\nif (bt2, b2x = rand(2)-1; b2y = rand(2)-1;,0);\n//if (bt2,bx2=b1x;b2y=b1y,0);\n\nsinb_=sinb;\ncosb_=cosb;\nbri = vol2*0.02+excite*0.015;\n\nq1= b1x*0.5;\nq2= b1y*0.5;\nmov = sqrt (v3*v3+v2*v2)/dt;  monitor = nomov;\n\n\nq17 =b2x*0.5;\nq18= b2y*0.5;\n\nq3 = pow(sinb,2)*bri * max(0,1-10*mov);\nq19= pow(cosb,2)*bri*1;\n\nmonitor = vol2\n;","pixel_eqs_eel":"warp = 0.0; zoom = 1; \ntx = tan((2*x-1)*0.9);\nty = tan((2*y-1)*0.9);\n\ndx = q12/q16* (1+0.5*abs(tx)); \ndy = q13/q16* (1+0.5*abs(ty)); \n\n\ndx += q13*ty*(x-0.5)*1; \ndy += q12*tx*(y-0.5)*1; \n\n//muss experimentell an tele angepasst werden; momentan 1.5 !!!","warp":"float seed, dist, struc, len; vec2 uv0, uv1; vec3 uv2; vec4 box;\nconst mat3 RotMat = mat3(q20,q21,q22,q23,q24,q25,q26,q27,q28);\nconst vec2 compxy = vec2 (q12,q13);\nconst vec3 CamPos = vec3(q4,q5,q6);\nconst float sustain = .97- q14, change = q14, ds = q10;\nconst float myzoom = q7, limit = 35, tele=q16;\nconst vec3 mod1 = (rand_preset > 0.5);\nfloat GetDist(vec2 uvi) {vec2 tmp; tmp = texture (sampler_pw_main, uvi).gb; \n  return 1-(tmp.y + 1.0/255*tmp.x);}\n\nvec2 PutDist(float x) {float fg, fb; fg = modf((1-x)*255.0,fb);\n  return (vec2(fg,fb/255.0));}\n\nfloat tdist (float d) {return tan(d*1.4)/1.4;}\n\nfloat MinDist (vec2 uvi, float d) \n{  vec4 nb; vec4 nb2; vec2 pix;\n   pix = texsize.zw*d;\n   nb.x = GetDist(uvi+pix*vec2(-1,-1));    nb.y = GetDist(uvi+pix*vec2(1,-1));\n   nb.z = GetDist(uvi+pix*vec2(1,1));      nb.w = GetDist(uvi+pix*vec2(-1,1));\n   nb2.x = GetDist(uvi+pix*vec2(0,-1));    nb2.y = GetDist(uvi+pix*vec2(1,0));\n   nb2.z = GetDist(uvi+pix*vec2(0,1));     nb2.w = GetDist(uvi+pix*vec2(-1,0));\n   nb = min( nb, nb2 );   nb.xy = min( nb.xy, nb.zw );\n   return min( nb.x, nb.y );\n}\n\nvec4 mbox (vec3 uvi) {vec3 zz, zz0; float tmp, li;\n  zz = uvi; zz0 = zz+q8; li=0;\n  for (int n = 0; n <= 8; n++) {\n    zz = 2.0*clamp(zz,-1,1)-zz;  tmp = dot(zz,zz);\n    zz *= max(.25/tmp, .25)*4;\n    zz = 2.6*zz + zz0;}\n  return vec4(zz,li);}\n\nshader_body {\nuv1 = (uv-.5)*aspect.xy*tele;\nuv = (uv-.5)*(1-ds/(GetDist(uv))) + .5;\n//uv = (uv-.5)*(1-(1.001*ds/tdist(GetDist(uv))+dot(compxy,uv1))) + .5;\n\nvec3 noise = fract(8*texture (sampler_noise_lq,uv+rand_frame.yz).xyz); \ndist = noise.r; seed = 1;\n   if (noise.g > 0.15) \n   {  seed = 0;vec3 noiseBiased = noise - 0.3;\n      dist = min (MinDist(uv,2), 111) +  0.008* noiseBiased.x * noise.y ; }\n\ndist = min(dist,GetDist(uv))- ds*0.7;\nuv2 = (RotMat * vec3(uv1*tdist(dist),tdist(dist)-.0)/myzoom)+CamPos;\nuv2 = (fract(uv2/4+.5)-.5)*2+vec3(1,2,3);\nbox = mbox (uv2); len = length(box.xyz); \n\nstruc = mix (clamp(1-1.5*dot(box,mod1)/limit, 0.0, 1.0),0.5,.0);\n\nif ((len < limit) && (dist > 0.04*(1-rad))){\n ret.r = mix (struc,texture(sampler_main, uv).xyz.r,sustain); ret.gb=  PutDist(dist); } \n else {ret = texture(sampler_fc_main,uv).xyz*sustain  - 1.0/255;} \n//ret = 0;\n}","comp":"float rdist, cross1;\nvec2 dz, dz1, uv0, uv1, uv4, uva, uvb;\nvec3 flash1, flash2, col1, col2;\nconst vec2 pos1 = vec2 (q1,q2);\nconst vec2 pos2 = vec2 (q17,q18);\nconst float pix = 0.002;\n\nfloat GetBuf(vec2 uvi)\n  {float res;\n  res = mix(((texture(sampler_blur1, uvi).xyz * scale1) + bias1).r,texture(sampler_main, uvi).xyz.r,0.15);\n  res = pow(res,1.2)*2;\n  return res * (res>0.06);}\n\nfloat aTan2(float y, float x) {float angle;\t float abs_y = abs(y);\nif (x >= 0) {float r = (x - abs_y) / (x + abs_y); angle = 1-r;} \nelse {float r = (x + abs_y) / (abs_y - x); angle = 3-r; }\t\n//angle = angle * .25;\nreturn y < 0 ? -angle : angle;}\n\nshader_body {\nuv += texsize.zw/2;\nuv0 = uv;\nrdist = ((texture(sampler_blur1, uv0).xyz * scale1) + bias1).b;\n\ndz1.x = GetBuf(uv+pix*vec2(1,0)) - GetBuf(uv+pix*vec2(-1,0));\ndz1.y = GetBuf(uv+pix*vec2(0,1)) - GetBuf(uv+pix*vec2(0,-1));\nuv += dz1 * clamp(1-((texture(sampler_blur1, uv).xyz * scale1) + bias1).r*0.8, 0.0, 1.0)*0.2;\nrdist = ((texture(sampler_blur1, uv).xyz * scale1) + bias1).b;\n\ncol1 = texture(sampler_noise_hq,rdist*0.05+time*0.02).xyz;\ncol1 = mix (col1,roam_sin,0.5);\ncol2 = texture(sampler_noise_hq,rdist*0.06+time*0.027).xyz;\ncol2 = mix (col2,roam_sin,0.5);\ncol2 = col1.bgr;\n\nuv4 = uv-0.5-((texture(sampler_blur1, uv).xyz * scale1) + bias1).r*0.4;\nuva = uv4-pos1;\nuvb = uv4-pos2;\ncross1 = abs(sin(M_PI*(aTan2(uva.x,uva.y)+4*q20)))+rdist*0.5+0.1;\nflash1 = 1/dot (uva,uva)/cross1*(1-rdist);\nflash2 = 1/dot (uvb,uvb)*(rdist+0.5);\n\nfloat r0 = rdist;\nret = clamp(1-2*r0, 0.0, 1.0) * (flash1*col1*q3 + flash2*(1-col1)*q19+0.1);\nret += clamp(2*r0, 0.0, 1.0)  * (flash1*col2*q3 + flash2*(1-col2)*q19);\n\nret += GetBuf(uv)*0.05;\n//ret *= 1-(rand_preset.y-0.5)*GetBuf(uv);\n\nret = 1-exp(-ret);\n\n}\n\n","warp_hlsl":"float seed, dist, struc, len; float2 uv0, uv1; float3 uv2; float4 box;\nstatic const float3x3 RotMat = float3x3(q20,q21,q22,q23,q24,q25,q26,q27,q28);\nstatic const float2 compxy = float2 (q12,q13);\nstatic const float3 CamPos = float3(q4,q5,q6);\nstatic const float sustain = .97- q14, change = q14, ds = q10;\nstatic const float myzoom = q7, limit = 35, tele=q16;\nstatic const float3 mod1 = (rand_preset > 0.5);\nfloat GetDist(float2 uvi) {float2 tmp; tmp = tex2D (sampler_pw_main, uvi).gb; \n  return 1-(tmp.y + 1.0/255*tmp.x);}\n\nfloat2 PutDist(float x) {float fg, fb; fg = modf((1-x)*255.0,fb);\n  return (float2(fg,fb/255.0));}\n\nfloat tdist (float d) {return tan(d*1.4)/1.4;}\n\nfloat MinDist (float2 uvi, float d) \n{  float4 nb; float4 nb2; float2 pix;\n   pix = texsize.zw*d;\n   nb.x = GetDist(uvi+pix*float2(-1,-1));    nb.y = GetDist(uvi+pix*float2(1,-1));\n   nb.z = GetDist(uvi+pix*float2(1,1));      nb.w = GetDist(uvi+pix*float2(-1,1));\n   nb2.x = GetDist(uvi+pix*float2(0,-1));    nb2.y = GetDist(uvi+pix*float2(1,0));\n   nb2.z = GetDist(uvi+pix*float2(0,1));     nb2.w = GetDist(uvi+pix*float2(-1,0));\n   nb = min( nb, nb2 );   nb.xy = min( nb.xy, nb.zw );\n   return min( nb.x, nb.y );\n}\n\nfloat4 mbox (float3 uvi) {float3 zz, zz0; float tmp, li;\n  zz = uvi; zz0 = zz+q8; li=0;\n  for (int n = 0; n <= 8; n++) {\n    zz = 2.0*clamp(zz,-1,1)-zz;  tmp = dot(zz,zz);\n    zz *= max(.25/tmp, .25)*4;\n    zz = 2.6*zz + zz0;}\n  return float4(zz,li);}\n\nshader_body {\nuv1 = (uv-.5)*aspect.xy*tele;\nuv = (uv-.5)*(1-ds/(GetDist(uv))) + .5;\n//uv = (uv-.5)*(1-(1.001*ds/tdist(GetDist(uv))+dot(compxy,uv1))) + .5;\n\nfloat3 noise = frac(8*tex2D (sampler_noise_lq,uv+rand_frame.yz)); \ndist = noise.r; seed = 1;\n   if (noise.g > 0.15) \n   {  seed = 0;float3 noiseBiased = noise - 0.3;\n      dist = min (MinDist(uv,2), 111) +  0.008* noiseBiased.x * noise.y ; }\n\ndist = min(dist,GetDist(uv))- ds*0.7;\nuv2 = mul(float3(uv1*tdist(dist),tdist(dist)-.0)/myzoom,RotMat)+CamPos;\nuv2 = (frac(uv2/4+.5)-.5)*2+float3(1,2,3);\nbox = mbox (uv2); len = length(box.xyz); \n\nstruc = lerp (saturate(1-1.5*dot(box,mod1)/limit),0.5,.0);\n\nif ((len < limit) && (dist > 0.04*(1-rad))){\n ret.r = lerp (struc,GetPixel(uv).r,sustain); ret.gb=  PutDist(dist); } \n else {ret = tex2D(sampler_fc_main,uv)*sustain  - 1.0/255;} \n//ret = 0;\n}","comp_hlsl":"float rdist, cross1;\nfloat2 dz, dz1, uv0, uv1, uv4, uva, uvb;\nfloat3 flash1, flash2, col1, col2;\nstatic const float2 pos1 = float2 (q1,q2);\nstatic const float2 pos2 = float2 (q17,q18);\nstatic const float pix = 0.002;\n\nfloat GetBuf(float2 uvi)\n  {float res;\n  res = lerp(GetBlur1(uvi).r,GetPixel(uvi).r,0.15);\n  res = pow(res,1.2)*2;\n  return res * (res>0.06);}\n\nfloat aTan2(float y, float x) {float angle;\t float abs_y = abs(y);\nif (x >= 0) {float r = (x - abs_y) / (x + abs_y); angle = 1-r;} \nelse {float r = (x + abs_y) / (abs_y - x); angle = 3-r; }\t\n//angle = angle * .25;\nreturn y < 0 ? -angle : angle;}\n\nshader_body {\nuv += texsize.zw/2;\nuv0 = uv;\nrdist = GetBlur1(uv0).b;\n\ndz1.x = GetBuf(uv+pix*float2(1,0)) - GetBuf(uv+pix*float2(-1,0));\ndz1.y = GetBuf(uv+pix*float2(0,1)) - GetBuf(uv+pix*float2(0,-1));\nuv += dz1 * saturate(1-GetBlur1(uv).r*0.8)*0.2;\nrdist = GetBlur1(uv).b;\n\ncol1 = tex2D(sampler_noise_hq,rdist*0.05+time*0.02);\ncol1 = lerp (col1,roam_sin,0.5);\ncol2 = tex2D(sampler_noise_hq,rdist*0.06+time*0.027);\ncol2 = lerp (col2,roam_sin,0.5);\ncol2 = col1.bgr;\n\nuv4 = uv-0.5-GetBlur1(uv).r*0.4;\nuva = uv4-pos1;\nuvb = uv4-pos2;\ncross1 = abs(sin(M_PI*(aTan2(uva.x,uva.y)+4*q20)))+rdist*0.5+0.1;\nflash1 = 1/dot (uva,uva)/cross1*(1-rdist);\nflash2 = 1/dot (uvb,uvb)*(rdist+0.5);\n\nfloat r0 = rdist;\nret = saturate(1-2*r0) * (flash1*col1*q3 + flash2*(1-col1)*q19+0.1);\nret += saturate(2*r0)  * (flash1*col2*q3 + flash2*(1-col2)*q19);\n\nret += GetBuf(uv)*0.05;\n//ret *= 1-(rand_preset.y-0.5)*GetBuf(uv);\n\nret = 1-exp(-ret);\n\n}\n\n"}