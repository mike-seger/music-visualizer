{"version":2,"baseVals":{"rating":5,"gammaadj":1.98,"decay":0.5,"echo_zoom":0.952,"echo_alpha":0.5,"echo_orient":3,"additivewave":1,"wave_thick":1,"modwavealphabyvolume":1,"wave_brighten":0,"darken":1,"wave_a":0.001,"wave_scale":0.021,"wave_smoothing":0.45,"modwavealphastart":0,"modwavealphaend":1.32,"warpanimspeed":1.459,"warpscale":2.007,"zoom":0.9999,"warp":0.00826,"sx":0.9999,"wave_r":0,"wave_g":0,"wave_b":0,"ob_size":0.05,"ib_size":0.26,"mv_x":0,"mv_y":0,"mv_l":1.85,"mv_r":0.5,"mv_g":0.5,"mv_b":0.5,"mv_a":0,"b2x":0.6,"b3x":0.4,"b1ed":0},"shapes":[{"baseVals":{"enabled":1,"sides":5,"num_inst":1000,"x":0.9,"y":0.9,"rad":0.1971,"tex_zoom":2.51821,"g":1,"b":1,"r2":1,"b2":1,"border_r":0,"border_g":0,"border_a":0},"init_eqs_str":"(function(){a['max_age'] = 0; a['y1'] = 0; a['x1'] = 0; a['age'] = 0; a['fac'] = 0; a['y0'] = 0; a['flim'] = 0; a['x0'] = 0; a['q31'] = 0; a['k1'] = 0; a['z0'] = 0; a['bright'] = 0; a['self'] = 0; a['size'] = 0; a['tmp'] = 0; a['z1'] = 0; a['q32'] = 0; a['q30'] = 0; }());","frame_eqs_str":"(function(){a['self']=(a['instance']*a['reg01']); a['age']=a['gmegabuf'][Math.floor((a['self']+12))]; a['max_age']=a['reg02']; a['size']=a['gmegabuf'][Math.floor((a['self']+13))]; a['flim']=a['gmegabuf'][Math.floor((a['self']+6))]; ((Math.abs(((a['age']>0)?1:0))>0.00001)?((function(){a['x0']=(a['gmegabuf'][Math.floor(a['self'])]-a['reg07']); a['y0']=(a['gmegabuf'][Math.floor((a['self']+1))]-a['reg08']); a['z0']=(a['gmegabuf'][Math.floor((a['self']+2))]-a['reg09']); a['x1']=(((a['x0']*a['reg30'])+(a['y0']*a['reg31']))+(a['z0']*a['reg32'])); a['y1']=(((a['x0']*a['reg33'])+(a['y0']*a['reg34']))+(a['z0']*a['reg35'])); a['z1']=(((a['x0']*a['reg36'])+(a['y0']*a['reg37']))+(a['z0']*a['reg38'])); return ((Math.abs(((a['z1']>0)?1:0))>0.00001)?((function(){a['fac']=a['reg19']; a['x']=(0.5+((div(a['x1'],a['z1'])*a['fac'])*a['q31'])); a['y']=(0.5-((div(a['y1'],a['z1'])*a['fac'])*a['q32'])); a['megabuf'][Math.floor(a['instance'])]=((a['megabuf'][Math.floor(a['instance'])]*0.5)+(0.5*(div(rand(100),100)-0.05))); a['bright']=(1-pow(div(a['age'],a['max_age']), 1)); a['bright']=Math.min(8, Math.max(0, ((2*a['bright'])*(((1-a['flim'])+div((0.5*a['flim']),a['megabuf'][Math.floor(a['instance'])]))-(0.5*a['megabuf'][Math.floor(a['instance'])]))))); a['a']=0.7; a['rad']=Math.min(0.2, (div((0.001*a['size']),a['z1'])*a['bright'])); a['k1']=1; a['r']=a['gmegabuf'][Math.floor((a['self']+9))]; a['g']=a['gmegabuf'][Math.floor((a['self']+10))]; a['b']=a['gmegabuf'][Math.floor((a['self']+11))]; a['tmp']=0.3; a['r2']=(a['r']*a['tmp']); a['g2']=(a['g']*a['tmp']); a['b2']=(a['b']*a['tmp']); a['a2']=0; return a['ang']=(a['z1']*1000);})()):((function(){a['gmegabuf'][Math.floor((a['self']+12))]+=a['q30']; return a['rad']=0;})()));})()):((function(){a['a']=0; return a['rad']=0;})()));}());","init_eqs_eel":"","frame_eqs_eel":"self = instance*reg01;\nage = gmegabuf(self+12);\nmax_age = reg02;\nsize = gmegabuf(self+13);\nflim = gmegabuf(self+6);\nif (age > 0,\n  x0 = gmegabuf(self)-reg07;\n  y0 = gmegabuf(self+1)-reg08;\n  z0 = gmegabuf(self+2)-reg09;\n\n\n  x1 = x0*reg30 + y0*reg31 + z0*reg32;\n  y1 = x0*reg33 + y0*reg34 + z0*reg35;\n  z1 = x0*reg36 + y0*reg37 + z0*reg38;\n\n\n  if (z1 > 0,\n    fac = reg19;;\n    x = .5 + x1/z1*fac*q31;\n    y = .5 - y1/z1*fac*q32;\n\n    megabuf(instance) = megabuf(instance)*.5 + .5*(rand(100)/100-.05);\n\n    bright = 1-pow(age/max_age,1);\n    bright =  min(8,max(0,2*bright*((1-flim)+.5*flim/megabuf(instance) - .5*megabuf(instance))));\n    a = .7;\n    rad = min(0.2,.001*size/z1*bright); \n    \n    k1 = 1;\n    r=gmegabuf(self+9);\n    g=gmegabuf(self+10);\n    b=gmegabuf(self+11);\n\n\n    tmp = .3;\n    r2 = r*tmp; g2 = g*tmp; b2 = b*tmp; \n    a2=0; \n    ang = z1*1000;\n  ,gmegabuf(self+12) += q30; rad = 0; ); //#age prematurely ?);\n\n, a=0; rad =0;) \n"},{"baseVals":{"enabled":1,"sides":7,"num_inst":800,"x":0.26,"y":0.2,"rad":0.01,"tex_zoom":0.9355,"g":0.5,"g2":0,"border_r":0,"border_g":0.7,"border_b":0.8,"border_a":0},"init_eqs_str":"(function(){a['y1'] = 0; a['x1'] = 0; a['age'] = 0; a['fac'] = 0; a['y0'] = 0; a['x0'] = 0; a['q31'] = 0; a['z0'] = 0; a['self'] = 0; a['size'] = 0; a['z1'] = 0; a['q32'] = 0; a['q30'] = 0; }());","frame_eqs_str":"(function(){a['self']=((a['instance']*a['reg01'])+a['reg13']); a['age']=a['gmegabuf'][Math.floor((a['self']+12))]; ((Math.abs(((a['age']>0)?1:0))>0.00001)?((function(){a['x0']=(a['gmegabuf'][Math.floor(a['self'])]-a['reg07']); a['y0']=(a['gmegabuf'][Math.floor((a['self']+1))]-a['reg08']); a['z0']=(a['gmegabuf'][Math.floor((a['self']+2))]-a['reg09']); a['size']=a['gmegabuf'][Math.floor((a['self']+13))]; a['x1']=(((a['x0']*a['reg30'])+(a['y0']*a['reg31']))+(a['z0']*a['reg32'])); a['y1']=(((a['x0']*a['reg33'])+(a['y0']*a['reg34']))+(a['z0']*a['reg35'])); a['z1']=(((a['x0']*a['reg36'])+(a['y0']*a['reg37']))+(a['z0']*a['reg38'])); return ((Math.abs(((a['z1']>0)?1:0))>0.00001)?((function(){a['fac']=a['reg19']; a['x']=(0.5+((div(a['x1'],a['z1'])*a['fac'])*a['q31'])); a['y']=(0.5-((div(a['y1'],a['z1'])*a['fac'])*a['q32'])); a['a']=Math.max(0, Math.min(1, (1-div(a['age'],a['reg12'])))); a['rad']=((div(0.0006,a['z1'])*a['size'])*((1+pow((1-a['age']), 6))+div((4*a['age']),a['reg12']))); a['rad']=Math.min(a['rad'], 0.1); a['r']=Math.min(1, (a['a']*4)); a['g']=a['a']; a['b']=pow(a['a'], 3); a['a']=0.2; return a['a2']=(a['a']*0.3);})()):((function(){a['gmegabuf'][Math.floor((a['self']+12))]+=a['q30']; return a['rad']=0;})()));})()):((function(){a['a']=0; return a['rad']=0;})()));}());","init_eqs_eel":"","frame_eqs_eel":"self = instance*reg01 + reg13;\n\nage = gmegabuf(self+12);\nif (age > 0,\n  x0 = gmegabuf(self)-reg07;\n  y0 = gmegabuf(self+1)-reg08;\n  z0 = gmegabuf(self+2)-reg09;\n  size = gmegabuf(self+13);\n\n  x1 = x0*reg30 + y0*reg31 + z0*reg32;\n  y1 = x0*reg33 + y0*reg34 + z0*reg35;\n  z1 = x0*reg36 + y0*reg37 + z0*reg38;\n\n  if (z1 > 0, \n    fac = reg19;;\n    x = .5 + x1/z1*fac*q31;\n    y = .5 - y1/z1*fac*q32;\n    a = max(0,min(1,1-age/reg12)) ;\n   \n    rad = .0006/z1*size*(1+ pow(1-age,6)+4*age/reg12);\n  \n    rad = min(rad,.1);\n    r = min(1,a*4); g = a; b = pow(a,3); \n    a = .2; a2 = a*.3;\n  ,gmegabuf(self+12)+=q30; rad= 0); //#age prematurely ?\n\n, a=0; rad =0);\n\n//if (instance == reg14-1, rad = .2, 0);\n"},{"baseVals":{"enabled":1,"sides":3,"num_inst":1000,"x":0.39,"y":0.4,"rad":0.01,"tex_zoom":0.4479,"r":0,"g":0.3,"b":1,"a":0.5,"r2":1,"b2":1,"border_r":0,"border_g":0,"border_b":0,"border_a":0},"init_eqs_str":"(function(){a['max_age'] = 0; a['y1'] = 0; a['x1'] = 0; a['age'] = 0; a['fac'] = 0; a['y0'] = 0; a['flim'] = 0; a['x0'] = 0; a['q31'] = 0; a['k1'] = 0; a['z0'] = 0; a['bright'] = 0; a['self'] = 0; a['size'] = 0; a['tmp'] = 0; a['z1'] = 0; a['q32'] = 0; a['q30'] = 0; }());","frame_eqs_str":"(function(){a['self']=((a['instance']+div(a['reg00'],2))*a['reg01']); a['age']=a['gmegabuf'][Math.floor((a['self']+12))]; a['max_age']=a['reg02']; a['size']=a['gmegabuf'][Math.floor((a['self']+13))]; a['flim']=a['gmegabuf'][Math.floor((a['self']+6))]; ((Math.abs(((a['age']>0)?1:0))>0.00001)?((function(){a['x0']=(a['gmegabuf'][Math.floor(a['self'])]-a['reg07']); a['y0']=(a['gmegabuf'][Math.floor((a['self']+1))]-a['reg08']); a['z0']=(a['gmegabuf'][Math.floor((a['self']+2))]-a['reg09']); a['x1']=(((a['x0']*a['reg30'])+(a['y0']*a['reg31']))+(a['z0']*a['reg32'])); a['y1']=(((a['x0']*a['reg33'])+(a['y0']*a['reg34']))+(a['z0']*a['reg35'])); a['z1']=(((a['x0']*a['reg36'])+(a['y0']*a['reg37']))+(a['z0']*a['reg38'])); return ((Math.abs(((a['z1']>0)?1:0))>0.00001)?((function(){a['fac']=a['reg19']; a['x']=(0.5+((div(a['x1'],a['z1'])*a['fac'])*a['q31'])); a['y']=(0.5-((div(a['y1'],a['z1'])*a['fac'])*a['q32'])); a['megabuf'][Math.floor(a['instance'])]=((a['megabuf'][Math.floor(a['instance'])]*0.5)+(0.5*(div(rand(100),100)-0.05))); a['bright']=(1-pow(div(a['age'],a['max_age']), 1)); a['bright']=Math.min(8, Math.max(0, ((2*a['bright'])*(((1-a['flim'])+div((0.5*a['flim']),a['megabuf'][Math.floor(a['instance'])]))-(0.5*a['megabuf'][Math.floor(a['instance'])]))))); a['a']=0.7; a['rad']=Math.min(0.2, (div((0.001*a['size']),a['z1'])*a['bright'])); a['k1']=1; a['r']=a['gmegabuf'][Math.floor((a['self']+9))]; a['g']=a['gmegabuf'][Math.floor((a['self']+10))]; a['b']=a['gmegabuf'][Math.floor((a['self']+11))]; a['tmp']=0.3; a['r2']=(a['r']*a['tmp']); a['g2']=(a['g']*a['tmp']); a['b2']=(a['b']*a['tmp']); a['a2']=0; return a['ang']=(a['z1']*1000);})()):((function(){a['gmegabuf'][Math.floor((a['self']+12))]+=a['q30']; return a['rad']=0;})()));})()):((function(){a['a']=0; return a['rad']=0;})()));}());","init_eqs_eel":"","frame_eqs_eel":"self = (instance+reg00/2)*reg01;\nage = gmegabuf(self+12);\nmax_age = reg02;\nsize = gmegabuf(self+13);\nflim = gmegabuf(self+6);\nif (age > 0,\n  x0 = gmegabuf(self)-reg07;\n  y0 = gmegabuf(self+1)-reg08;\n  z0 = gmegabuf(self+2)-reg09;\n\n\n  x1 = x0*reg30 + y0*reg31 + z0*reg32;\n  y1 = x0*reg33 + y0*reg34 + z0*reg35;\n  z1 = x0*reg36 + y0*reg37 + z0*reg38;\n\n\n  if (z1 > 0,\n    fac = reg19;;\n    x = .5 + x1/z1*fac*q31;\n    y = .5 - y1/z1*fac*q32;\n\n    megabuf(instance) = megabuf(instance)*.5 + .5*(rand(100)/100-.05);\n\n    bright = 1-pow(age/max_age,1);\n    bright =  min(8,max(0,2*bright*((1-flim)+.5*flim/megabuf(instance) - .5*megabuf(instance))));\n    a = .7;\n    rad = min(0.2,.001*size/z1*bright); \n    \n    k1 = 1;\n    r=gmegabuf(self+9);\n    g=gmegabuf(self+10);\n    b=gmegabuf(self+11);\n\n\n    tmp = .3;\n    r2 = r*tmp; g2 = g*tmp; b2 = b*tmp; \n    a2=0; \n    ang = z1*1000;\n  ,gmegabuf(self+12) += q30; rad = 0; ); //#age prematurely ?);\n\n, a=0; rad =0;) \n"},{"baseVals":{"enabled":1,"sides":6,"additive":1,"num_inst":350,"x":0.65,"y":0.8,"rad":0.01,"tex_zoom":0.3357,"g2":0,"border_r":0,"border_g":0,"border_b":0,"border_a":0},"init_eqs_str":"(function(){a['max_age'] = 0; a['y1'] = 0; a['x1'] = 0; a['age'] = 0; a['fac'] = 0; a['y0'] = 0; a['x0'] = 0; a['q31'] = 0; a['z0'] = 0; a['self'] = 0; a['z1'] = 0; a['q32'] = 0; a['q30'] = 0; }());","frame_eqs_str":"(function(){a['self']=((Math.floor((div(a['instance'],a['num_inst'])*a['reg20']))*a['reg01'])+100000); a['age']=a['gmegabuf'][Math.floor((a['self']+12))]; ((Math.abs(((a['age']>0)?1:0))>0.00001)?((function(){a['max_age']=a['reg22']; a['x0']=(a['gmegabuf'][Math.floor(a['self'])]-a['reg07']); a['y0']=(a['gmegabuf'][Math.floor((a['self']+1))]-a['reg08']); a['z0']=(a['gmegabuf'][Math.floor((a['self']+2))]-a['reg09']); a['x1']=(((a['x0']*a['reg30'])+(a['y0']*a['reg31']))+(a['z0']*a['reg32'])); a['y1']=(((a['x0']*a['reg33'])+(a['y0']*a['reg34']))+(a['z0']*a['reg35'])); a['z1']=(((a['x0']*a['reg36'])+(a['y0']*a['reg37']))+(a['z0']*a['reg38'])); return ((Math.abs(((a['z1']>0)?1:0))>0.00001)?((function(){a['rad']=Math.min(0.1, div(0.003,a['z1'])); a['r']=a['gmegabuf'][Math.floor((a['self']+9))]; a['g']=a['gmegabuf'][Math.floor((a['self']+10))]; a['b']=a['gmegabuf'][Math.floor((a['self']+11))]; a['r2']=div(a['r'],3); a['b2']=div(a['b'],3); a['g2']=div(a['g'],3); a['a']=(0.17*Math.max(0, (1-div(a['age'],a['max_age'])))); a['a2']=0; a['fac']=a['reg19']; a['x']=(0.5+((div(a['x1'],a['z1'])*a['fac'])*a['q31'])); return a['y']=(0.5-((div(a['y1'],a['z1'])*a['fac'])*a['q32']));})()):((function(){a['gmegabuf'][Math.floor((a['self']+12))]+=(4*a['q30']); a['a']=0; return a['rad']=0;})()));})()):((function(){a['a']=0; return a['rad']=0;})()));}());","init_eqs_eel":"","frame_eqs_eel":"self = int(instance/num_inst*reg20)*reg01 + 100000; //#\n\nage = gmegabuf(self+12);\nif (age > 0,\n  max_age = reg22;\n  x0 = gmegabuf(self)-reg07;\n  y0 = gmegabuf(self+1)-reg08;\n  z0 = gmegabuf(self+2)-reg09;\n\n\n  x1 = x0*reg30 + y0*reg31 + z0*reg32;\n  y1 = x0*reg33 + y0*reg34 + z0*reg35;\n  z1 = x0*reg36 + y0*reg37 + z0*reg38;\n\n\n  if (z1 > 0,\n    rad = min(.1,.003/z1); //###\n   \n    r = gmegabuf(self+9);\n    g = gmegabuf(self+10);\n    b = gmegabuf(self+11);\n    r2 = r/3; b2 = b/3; g2 = g/3;\n    a = .17 * max(0,1-age/max_age);  a2 = 0;\n    fac = reg19;;\n    x = .5 + x1/z1*fac*q31;\n    y = .5 - y1/z1*fac*q32;\n  ,gmegabuf(self+12) += 4*q30; a= 0; rad=0); //#age prematurely ?);\n\n, a=0; rad=0;) ;\n"}],"waves":[{"baseVals":{"enabled":1,"sep":20,"usedots":1,"additive":1,"scaling":0.2946,"smoothing":0.1,"g":0.3,"a":0.6},"init_eqs_str":"(function(){a['max_age'] = 0; a['y1'] = 0; a['t1'] = 0; a['x1'] = 0; a['age'] = 0; a['fac'] = 0; a['y0'] = 0; a['x0'] = 0; a['z0'] = 0; a['self'] = 0; a['z1'] = 0; a['q30'] = 0; a['t0']=0;}());","frame_eqs_str":"(function(){a['t1']=0;}());","point_eqs_str":"(function(){a['self']=((a['t1']*a['reg01'])+100000); a['age']=a['gmegabuf'][Math.floor((a['self']+12))]; a['max_age']=a['reg22']; ((Math.abs(((a['age']>0)?1:0))>0.00001)?((function(){a['x0']=(a['gmegabuf'][Math.floor(a['self'])]-a['reg07']); a['y0']=(a['gmegabuf'][Math.floor((a['self']+1))]-a['reg08']); a['z0']=(a['gmegabuf'][Math.floor((a['self']+2))]-a['reg09']); a['x1']=(((a['x0']*a['reg30'])+(a['y0']*a['reg31']))+(a['z0']*a['reg32'])); a['y1']=(((a['x0']*a['reg33'])+(a['y0']*a['reg34']))+(a['z0']*a['reg35'])); a['z1']=(((a['x0']*a['reg36'])+(a['y0']*a['reg37']))+(a['z0']*a['reg38'])); return ((Math.abs(((a['z1']>0)?1:0))>0.00001)?((function(){a['a']=(Math.min(1, div(0.03,a['z1']))*Math.max(0, (1-div(a['age'],a['max_age'])))); a['r']=a['gmegabuf'][Math.floor((a['self']+9))]; a['g']=a['gmegabuf'][Math.floor((a['self']+10))]; a['b']=a['gmegabuf'][Math.floor((a['self']+11))]; a['fac']=a['reg19']; a['x']=(0.5+(div(a['x1'],a['z1'])*a['fac'])); return a['y']=(0.5-(div(a['y1'],a['z1'])*a['fac']));})()):((function(){a['gmegabuf'][Math.floor((a['self']+12))]+=(4*a['q30']); return a['a']=0;})()));})()):(a['a']=0)); a['t1']+=1;}());","init_eqs_eel":"t0 = 0;","frame_eqs_eel":"t1 = 0;","point_eqs_eel":"self = t1*reg01 + 100000; //#\n\nage = gmegabuf(self+12);\nmax_age = reg22;\nif (age > 0,\n  x0 = gmegabuf(self)-reg07;\n  y0 = gmegabuf(self+1)-reg08;\n  z0 = gmegabuf(self+2)-reg09;\n\n\n  x1 = x0*reg30 + y0*reg31 + z0*reg32;\n  y1 = x0*reg33 + y0*reg34 + z0*reg35;\n  z1 = x0*reg36 + y0*reg37 + z0*reg38;\n\n\n  if (z1 > 0,\n    a = min(1,.03/z1)* max(0,1-age/max_age); //###\n    r = gmegabuf(self+9);\n    g = gmegabuf(self+10);\n    b = gmegabuf(self+11);\n    fac = reg19;;\n    x = .5 + x1/z1*fac;\n    y = .5 - y1/z1*fac;\n  ,gmegabuf(self+12) += 4*q30; a= 0; ); //#age prematurely ?);\n\n, a=0; ) ;\n\nt1 += 1;"},{"baseVals":{"enabled":1,"usedots":1,"additive":1,"scaling":0.14869,"smoothing":0.82,"a":0.1},"init_eqs_str":"(function(){a['max_age'] = 0; a['y1'] = 0; a['t1'] = 0; a['x1'] = 0; a['age'] = 0; a['fac'] = 0; a['y0'] = 0; a['x0'] = 0; a['z0'] = 0; a['self'] = 0; a['z1'] = 0; a['q30'] = 0; }());","frame_eqs_str":"(function(){a['t1']=a['samples'];}());","point_eqs_str":"(function(){a['self']=((a['t1']*a['reg01'])+100000); a['age']=a['gmegabuf'][Math.floor((a['self']+12))]; a['max_age']=a['reg22']; ((Math.abs(((a['age']>0)?1:0))>0.00001)?((function(){a['x0']=(a['gmegabuf'][Math.floor(a['self'])]-a['reg07']); a['y0']=(a['gmegabuf'][Math.floor((a['self']+1))]-a['reg08']); a['z0']=(a['gmegabuf'][Math.floor((a['self']+2))]-a['reg09']); a['x1']=(((a['x0']*a['reg30'])+(a['y0']*a['reg31']))+(a['z0']*a['reg32'])); a['y1']=(((a['x0']*a['reg33'])+(a['y0']*a['reg34']))+(a['z0']*a['reg35'])); a['z1']=(((a['x0']*a['reg36'])+(a['y0']*a['reg37']))+(a['z0']*a['reg38'])); return ((Math.abs(((a['z1']>0)?1:0))>0.00001)?((function(){a['a']=(Math.min(1, div(0.03,a['z1']))*Math.max(0, (1-div(a['age'],a['max_age'])))); a['r']=a['gmegabuf'][Math.floor((a['self']+9))]; a['g']=a['gmegabuf'][Math.floor((a['self']+10))]; a['b']=a['gmegabuf'][Math.floor((a['self']+11))]; a['fac']=a['reg19']; a['x']=(0.5+(div(a['x1'],a['z1'])*a['fac'])); return a['y']=(0.5-(div(a['y1'],a['z1'])*a['fac']));})()):((function(){a['gmegabuf'][Math.floor((a['self']+12))]+=(4*a['q30']); return a['a']=0;})()));})()):(a['a']=0)); a['t1']+=1;}());","init_eqs_eel":"","frame_eqs_eel":"t1 = samples;","point_eqs_eel":"self = t1*reg01 + 100000; //#\n\nage = gmegabuf(self+12);\nmax_age = reg22;\nif (age > 0,\n  x0 = gmegabuf(self)-reg07;\n  y0 = gmegabuf(self+1)-reg08;\n  z0 = gmegabuf(self+2)-reg09;\n\n\n  x1 = x0*reg30 + y0*reg31 + z0*reg32;\n  y1 = x0*reg33 + y0*reg34 + z0*reg35;\n  z1 = x0*reg36 + y0*reg37 + z0*reg38;\n\n\n  if (z1 > 0,\n    a = min(1,.03/z1)* max(0,1-age/max_age); //###\n    r = gmegabuf(self+9);\n    g = gmegabuf(self+10);\n    b = gmegabuf(self+11);\n    fac = reg19;;\n    x = .5 + x1/z1*fac;\n    y = .5 - y1/z1*fac;\n  ,gmegabuf(self+12) += 4*q30; a= 0; ); //#age prematurely ?);\n\n, a=0; ) ;\n\nt1 += 1;"},{"baseVals":{"enabled":1,"usedots":1,"additive":1,"scaling":0.89152,"smoothing":0.82},"init_eqs_str":"(function(){a['max_age'] = 0; a['y1'] = 0; a['t1'] = 0; a['x1'] = 0; a['age'] = 0; a['fac'] = 0; a['y0'] = 0; a['x0'] = 0; a['z0'] = 0; a['self'] = 0; a['z1'] = 0; a['q30'] = 0; }());","frame_eqs_str":"(function(){a['t1']=(a['samples']*2);}());","point_eqs_str":"(function(){a['self']=((a['t1']*a['reg01'])+100000); a['age']=a['gmegabuf'][Math.floor((a['self']+12))]; a['max_age']=a['reg22']; ((Math.abs(((a['age']>0)?1:0))>0.00001)?((function(){a['x0']=(a['gmegabuf'][Math.floor(a['self'])]-a['reg07']); a['y0']=(a['gmegabuf'][Math.floor((a['self']+1))]-a['reg08']); a['z0']=(a['gmegabuf'][Math.floor((a['self']+2))]-a['reg09']); a['x1']=(((a['x0']*a['reg30'])+(a['y0']*a['reg31']))+(a['z0']*a['reg32'])); a['y1']=(((a['x0']*a['reg33'])+(a['y0']*a['reg34']))+(a['z0']*a['reg35'])); a['z1']=(((a['x0']*a['reg36'])+(a['y0']*a['reg37']))+(a['z0']*a['reg38'])); return ((Math.abs(((a['z1']>0)?1:0))>0.00001)?((function(){a['a']=(Math.min(1, div(0.03,a['z1']))*Math.max(0, (1-div(a['age'],a['max_age'])))); a['r']=a['gmegabuf'][Math.floor((a['self']+9))]; a['g']=a['gmegabuf'][Math.floor((a['self']+10))]; a['b']=a['gmegabuf'][Math.floor((a['self']+11))]; a['fac']=a['reg19']; a['x']=(0.5+(div(a['x1'],a['z1'])*a['fac'])); return a['y']=(0.5-(div(a['y1'],a['z1'])*a['fac']));})()):((function(){a['gmegabuf'][Math.floor((a['self']+12))]+=(4*a['q30']); return a['a']=0;})()));})()):(a['a']=0)); a['t1']+=1;}());","init_eqs_eel":"","frame_eqs_eel":"t1 = samples*2;","point_eqs_eel":"self = t1*reg01 + 100000; //#\n\nage = gmegabuf(self+12);\nmax_age = reg22;\nif (age > 0,\n  x0 = gmegabuf(self)-reg07;\n  y0 = gmegabuf(self+1)-reg08;\n  z0 = gmegabuf(self+2)-reg09;\n\n\n  x1 = x0*reg30 + y0*reg31 + z0*reg32;\n  y1 = x0*reg33 + y0*reg34 + z0*reg35;\n  z1 = x0*reg36 + y0*reg37 + z0*reg38;\n\n\n  if (z1 > 0,\n    a = min(1,.03/z1)* max(0,1-age/max_age); //###\n    r = gmegabuf(self+9);\n    g = gmegabuf(self+10);\n    b = gmegabuf(self+11);\n    fac = reg19;;\n    x = .5 + x1/z1*fac;\n    y = .5 - y1/z1*fac;\n  ,gmegabuf(self+12) += 4*q30; a= 0; ); //#age prematurely ?);\n\n, a=0; ) ;\n\nt1 += 1;"},{"baseVals":{"enabled":1,"usedots":1,"additive":1,"scaling":1.22018,"smoothing":0.2},"init_eqs_str":"(function(){a['max_age'] = 0; a['y1'] = 0; a['t1'] = 0; a['x1'] = 0; a['age'] = 0; a['fac'] = 0; a['y0'] = 0; a['x0'] = 0; a['z0'] = 0; a['self'] = 0; a['z1'] = 0; a['q30'] = 0; }());","frame_eqs_str":"(function(){a['t1']=(a['samples']*3);}());","point_eqs_str":"(function(){a['self']=((a['t1']*a['reg01'])+100000); a['age']=a['gmegabuf'][Math.floor((a['self']+12))]; a['max_age']=a['reg22']; ((Math.abs(((a['age']>0)?1:0))>0.00001)?((function(){a['x0']=(a['gmegabuf'][Math.floor(a['self'])]-a['reg07']); a['y0']=(a['gmegabuf'][Math.floor((a['self']+1))]-a['reg08']); a['z0']=(a['gmegabuf'][Math.floor((a['self']+2))]-a['reg09']); a['x1']=(((a['x0']*a['reg30'])+(a['y0']*a['reg31']))+(a['z0']*a['reg32'])); a['y1']=(((a['x0']*a['reg33'])+(a['y0']*a['reg34']))+(a['z0']*a['reg35'])); a['z1']=(((a['x0']*a['reg36'])+(a['y0']*a['reg37']))+(a['z0']*a['reg38'])); return ((Math.abs(((a['z1']>0)?1:0))>0.00001)?((function(){a['a']=(Math.min(1, div(0.03,a['z1']))*Math.max(0, (1-div(a['age'],a['max_age'])))); a['r']=a['gmegabuf'][Math.floor((a['self']+9))]; a['g']=a['gmegabuf'][Math.floor((a['self']+10))]; a['b']=a['gmegabuf'][Math.floor((a['self']+11))]; a['fac']=a['reg19']; a['x']=(0.5+(div(a['x1'],a['z1'])*a['fac'])); return a['y']=(0.5-(div(a['y1'],a['z1'])*a['fac']));})()):((function(){a['gmegabuf'][Math.floor((a['self']+12))]+=(4*a['q30']); return a['a']=0;})()));})()):(a['a']=0)); a['t1']+=1;}());","init_eqs_eel":"","frame_eqs_eel":"t1 = samples*3;","point_eqs_eel":"self = t1*reg01 + 100000; //#\n\nage = gmegabuf(self+12);\nmax_age = reg22;\nif (age > 0,\n  x0 = gmegabuf(self)-reg07;\n  y0 = gmegabuf(self+1)-reg08;\n  z0 = gmegabuf(self+2)-reg09;\n\n\n  x1 = x0*reg30 + y0*reg31 + z0*reg32;\n  y1 = x0*reg33 + y0*reg34 + z0*reg35;\n  z1 = x0*reg36 + y0*reg37 + z0*reg38;\n\n\n  if (z1 > 0,\n    a = min(1,.03/z1)* max(0,1-age/max_age); //###\n    r = gmegabuf(self+9);\n    g = gmegabuf(self+10);\n    b = gmegabuf(self+11);\n    fac = reg19;;\n    x = .5 + x1/z1*fac;\n    y = .5 - y1/z1*fac;\n  ,gmegabuf(self+12) += 4*q30; a= 0; ); //#age prematurely ?);\n\n, a=0; ) ;\n\nt1 += 1;"}],"init_eqs_str":"(function(){a['max_age'] = 0; a['zcam'] = 0; a['att0'] = 0; a['n'] = 0; a['y1'] = 0; a['n2'] = 0; a['cmovy'] = 0; a['free'] = 0; a['sharp'] = 0; a['index2'] = 0; a['reg07'] = 0; a['reg34'] = 0; a['g0'] = 0; a['right'] = 0; a['reg43'] = 0; a['tbase'] = 0; a['y0_'] = 0; a['q25'] = 0; a['vx0'] = 0; a['reg05'] = 0; a['brake'] = 0; a['index'] = 0; a['q12'] = 0; a['reg04'] = 0; a['up'] = 0; a['v3'] = 0; a['dzcam'] = 0; a['z0_'] = 0; a['q18'] = 0; a['x1'] = 0; a['q22'] = 0; a['age'] = 0; a['q21'] = 0; a['obj_num'] = 0; a['fac'] = 0; a['cw'] = 0; a['q13'] = 0; a['reg08'] = 0; a['q15'] = 0; a['sp0'] = 0; a['q29'] = 0; a['q6'] = 0; a['dt'] = 0; a['y0'] = 0; a['flim'] = 0; a['reg48'] = 0; a['hspeed'] = 0; a['q1'] = 0; a['q5'] = 0; a['dxcam'] = 0; a['n1'] = 0; a['reg52'] = 0; a['dec_f'] = 0; a['self2'] = 0; a['head_ptr'] = 0; a['x0'] = 0; a['i3'] = 0; a['new'] = 0; a['n4'] = 0; a['dec_s'] = 0; a['camdist'] = 0; a['ax'] = 0; a['vx1'] = 0; a['reg36'] = 0; a['reg50'] = 0; a['num2'] = 0; a['crot'] = 0; a['vol_att'] = 0; a['reg58'] = 0; a['reg09'] = 0; a['reg45'] = 0; a['new_'] = 0; a['att1'] = 0; a['is_beat'] = 0; a['q31'] = 0; a['cal'] = 0; a['q23'] = 0; a['k1'] = 0; a['q24'] = 0; a['vx'] = 0; a['q11'] = 0; a['vy0'] = 0; a['z0'] = 0; a['hlock'] = 0; a['style'] = 0; a['x0_'] = 0; a['q10'] = 0; a['reg53'] = 0; a['xcam'] = 0; a['ranpt'] = 0; a['vy'] = 0; a['vz'] = 0; a['i1'] = 0; a['reg31'] = 0; a['reg06'] = 0; a['v0'] = 0; a['dec_m'] = 0; a['ran'] = 0; a['start'] = 0; a['t_age'] = 0; a['cfwd'] = 0; a['pspeed'] = 0; a['t_ptr'] = 0; a['t_num'] = 0; a['reg54'] = 0; a['c2'] = 0; a['reg37'] = 0; a['s3'] = 0; a['self'] = 0; a['reg55'] = 0; a['vz0'] = 0; a['q16'] = 0; a['q26'] = 0; a['mage2'] = 0; a['reg57'] = 0; a['ay'] = 0; a['reg38'] = 0; a['colg'] = 0; a['reg35'] = 0; a['reg56'] = 0; a['reg46'] = 0; a['camspeed'] = 0; a['reg41'] = 0; a['avg'] = 0; a['csum'] = 0; a['reg44'] = 0; a['colr'] = 0; a['c3'] = 0; a['ptr2'] = 0; a['q19'] = 0; a['theta'] = 0; a['tspeed'] = 0; a['q17'] = 0; a['cmovx'] = 0; a['reg32'] = 0; a['free2'] = 0; a['peak'] = 0; a['reg47'] = 0; a['base2'] = 0; a['dt2'] = 0; a['vy1'] = 0; a['reg30'] = 0; a['q2'] = 0; a['q27'] = 0; a['q14'] = 0; a['dist'] = 0; a['n3'] = 0; a['reg51'] = 0; a['v1'] = 0; a['reg42'] = 0; a['z1'] = 0; a['gspeed'] = 0; a['speed'] = 0; a['i2'] = 0; a['q3'] = 0; a['s1'] = 0; a['vz1'] = 0; a['t0'] = 0; a['dec'] = 0; a['s2'] = 0; a['m'] = 0; a['reg40'] = 0; a['circles'] = 0; a['camlock'] = 0; a['q32'] = 0; a['reg33'] = 0; a['phi'] = 0; a['ltest'] = 0; a['q7'] = 0; a['q28'] = 0; a['point'] = 0; a['t_free'] = 0; a['dycam'] = 0; a['q30'] = 0; a['ycam'] = 0; a['c1'] = 0; a['v2'] = 0; a['fail'] = 0; a['colb'] = 0; a['q20'] = 0; a['az'] = 0; a['obj_size'] = 0; a['gspeed']=0.65; a['hspeed']=0.03; a['pspeed']=0.06; a['tspeed']=(a['hspeed']*3.5); a['camdist']=0.03; a['camspeed']=0.27; a['camlock']=6; a['hlock']=0.1; a['sharp']=40; a['g0']=0.12; a['cw']=50; a['n']=0; for(var mdparser_idx83=0;mdparser_idx83<150000;mdparser_idx83++){a['gmegabuf'][Math.floor(a['n'])]=0; a['n']+=1;} a['fac']=0.4; a['reg19']=a['fac']; a['obj_num']=2000; a['reg00']=a['obj_num']; a['obj_size']=16; a['reg01']=a['obj_size']; a['max_age']=3.8; a['reg02']=a['max_age']; a['head_ptr']=0; a['free']=0; a['num2']=2048; a['reg20']=a['num2']; a['free2']=0; a['ptr2']=0; a['mage2']=1; a['reg22']=a['mage2']; a['base2']=100000; a['t_num']=800; a['reg10']=a['t_num']; a['t_age']=1; a['reg12']=a['t_age']; a['tbase']=(a['obj_num']*a['obj_size']); a['reg13']=a['tbase']; a['t_ptr']=0; a['t_free']=0; a['x0']=((rand(10)-5)*0.03); a['y0']=((rand(10)-5)*0.03); a['z0']=((rand(10)-5)*0.03); a['xcam']=0; a['ycam']=0.0; a['zcam']=-0; a['c1']=Math.cos(0); a['c2']=Math.cos(0); a['c3']=Math.cos(0); a['s1']=Math.sin(0); a['s2']=Math.sin(0); a['s3']=Math.sin(0); a['reg30']=(a['c2']*a['c1']); a['reg31']=(a['c2']*a['s1']); a['reg32']=-a['s2']; a['reg33']=(((a['s3']*a['s2'])*a['c1'])-(a['c3']*a['s1'])); a['reg34']=(((a['s3']*a['s2'])*a['s1'])+(a['c3']*a['c1'])); a['reg35']=(a['s3']*a['c2']); a['reg36']=(((a['c3']*a['s2'])*a['c1'])+(a['s3']*a['s1'])); a['reg37']=(((a['c3']*a['s2'])*a['s1'])-(a['s3']*a['c1'])); a['reg38']=(a['c3']*a['c2']); a['reg50']=(a['c2']*a['c1']); a['reg51']=(a['c2']*a['s1']); a['reg52']=-a['s2']; a['reg53']=(((a['s3']*a['s2'])*a['c1'])-(a['c3']*a['s1'])); a['reg54']=(((a['s3']*a['s2'])*a['s1'])+(a['c3']*a['c1'])); a['reg55']=(a['s3']*a['c2']); a['reg56']=(((a['c3']*a['s2'])*a['c1'])+(a['s3']*a['s1'])); a['reg57']=(((a['c3']*a['s2'])*a['s1'])-(a['s3']*a['c1'])); a['reg58']=(a['c3']*a['c2']); a['tmp']=rand(12); a['colr']=(1-div(rand(100),300)); a['colg']=(1-div(rand(100),300)); a['colb']=(1-div(rand(100),300)); a['posx']=div(rand(1000),100); a['posz']=div(rand(1000),100); a['n1']=div(rand(10),20); a['n2']=div(rand(10),20); a['n3']=div(rand(10),20); a['n4']=div(rand(10),20); a['i1']=div(rand(10),20); a['i2']=div(rand(10),20); a['i3']=div(rand(10),20); a['i4']=div(rand(10),20); a['index2']=Math.floor(rand(32)); a['start']=0.9;}());","frame_eqs_str":"(function(){a['dt']=div(a['gspeed'],a['fps']); a['dt2']=a['dt']; a['dec_s']=(1-div((0.015*30),a['fps'])); a['dec_m']=pow(0.95, div(30,a['fps'])); a['dec_f']=pow(0.85, div(30,a['fps'])); a['vol_att']=div(((a['bass']+a['mid'])+a['treb']),3); a['avg']=((a['avg']*a['dec_s'])+(((1-a['dec_s'])*a['vol_att'])*(1.5-div(0.2,a['cal'])))); a['is_beat']=(above(a['vol_att'], (1.25*a['peak']))*above(a['time'], (a['t0']+0.3))); a['t0']=((Math.abs(a['is_beat'])>0.00001)?(a['time']):(a['t0'])); a['peak']=((a['peak']*a['dec_m'])+((1-a['dec_m'])*a['vol_att'])); a['index']=mod((a['index']+a['is_beat']),16); a['index2']=mod((a['index2']+(a['is_beat']*bnot(a['index']))),16); a['right']=div(((((pow((a['bass_att']-a['avg']), 1)*((a['bass_att']>a['avg'])?1:0))*a['sharp'])*a['n1'])*Math.sin((a['time']*3))),a['cal']); a['up']=div((((pow((a['treb_att']-a['avg']), 1)*((a['treb_att']>a['avg'])?1:0))*a['sharp'])*a['n2']),a['cal']); a['cal']=Math.max(0.2, ((a['cal']*a['dec_s'])+div(((1-a['dec_s'])*sqrt(((a['up']*a['up'])+(a['right']*a['right'])))),4))); ((Math.abs((((Math.abs((mod(a['index'],6))-(0))<0.00001)?1:0)*a['is_beat']))>0.00001)?((function(){a['n1']=(div(rand(100),100)-0.5); a['n2']=(div(rand(100),100)-0.5); a['n3']=(div(rand(100),100)-0.5); a['n4']=(pow(div(rand(100),70), 2)+0.05); a['i1']=(1+Math.floor(rand(6))); a['i2']=(1+Math.floor(rand(6))); return a['i3']=(1+Math.floor(rand(6)));})()):(0)); a['sp0']=((0.5+sqrt((a['vol_att']*4)))*a['hspeed']); a['dec']=((Math.abs(((a['sp0']>a['speed'])?1:0))>0.00001)?(0.5):(a['dec_m'])); a['speed']=((a['speed']*a['dec'])+((1-a['dec'])*a['sp0'])); a['c1']=Math.cos((a['up']*a['dt'])); a['c2']=Math.cos((a['right']*a['dt'])); a['c3']=1; a['s1']=Math.sin((a['up']*a['dt'])); a['s2']=Math.sin((a['right']*a['dt'])); a['s3']=0; a['reg40']=(a['c2']*a['c3']); a['reg41']=(a['c2']*a['s3']); a['reg42']=-a['s2']; a['reg43']=(((a['s1']*a['s2'])*a['c3'])-(a['c1']*a['s3'])); a['reg44']=(((a['s1']*a['s2'])*a['s3'])+(a['c1']*a['c3'])); a['reg45']=(a['s1']*a['c2']); a['reg46']=(((a['c1']*a['s2'])*a['c3'])+(a['s1']*a['s3'])); a['reg47']=(((a['c1']*a['s2'])*a['s3'])-(a['s1']*a['c3'])); a['reg48']=(a['c1']*a['c2']); a['q20']=(((a['reg40']*a['reg50'])+(a['reg41']*a['reg53']))+(a['reg42']*a['reg56'])); a['q21']=(((a['reg40']*a['reg51'])+(a['reg41']*a['reg54']))+(a['reg42']*a['reg57'])); a['q22']=(((a['reg40']*a['reg52'])+(a['reg41']*a['reg55']))+(a['reg42']*a['reg58'])); a['q23']=(((a['reg43']*a['reg50'])+(a['reg44']*a['reg53']))+(a['reg45']*a['reg56'])); a['q24']=(((a['reg43']*a['reg51'])+(a['reg44']*a['reg54']))+(a['reg45']*a['reg57'])); a['q25']=(((a['reg43']*a['reg52'])+(a['reg44']*a['reg55']))+(a['reg45']*a['reg58'])); a['q26']=(((a['reg46']*a['reg50'])+(a['reg47']*a['reg53']))+(a['reg48']*a['reg56'])); a['q27']=(((a['reg46']*a['reg51'])+(a['reg47']*a['reg54']))+(a['reg48']*a['reg57'])); a['q28']=(((a['reg46']*a['reg52'])+(a['reg47']*a['reg55']))+(a['reg48']*a['reg58'])); a['reg50']=a['q20']; a['reg51']=a['q21']; a['reg52']=a['q22']; a['reg53']=a['q23']; a['reg54']=a['q24']; a['reg55']=a['q25']; a['reg56']=a['q26']; a['reg57']=a['q27']; a['reg58']=a['q28']; a['vx0']=(a['reg56']*a['speed']); a['vy0']=(a['reg57']*a['speed']); a['vz0']=(a['reg58']*a['speed']); a['x0']=(a['x0']+(a['vx0']*a['dt'])); a['reg04']=a['x0']; a['y0']=Math.max(-0.5, Math.min(0.5, (a['y0']+(a['vy0']*a['dt'])))); a['reg05']=a['y0']; a['z0']=(a['z0']+(a['vz0']*a['dt'])); a['reg06']=a['z0']; a['ltest']=0; a['style']=((a['n1']>0)?1:0); a['circles']=((a['index2']>=12)?1:0); ((Math.abs(((Math.abs((a['style'])-(0))<0.00001)?1:0))>0.00001)?(a['new']=Math.max(0, Math.min(((1800*a['dt'])*((a['mid']>1.2)?1:0)), a['free']))):(0)); ((Math.abs(((Math.abs((a['style'])-(1))<0.00001)?1:0))>0.00001)?(a['new']=Math.max(0, Math.min(((200*a['vol_att'])*(((a['vol_att']*200)>((50+a['obj_num'])-a['free']))?1:0)), (a['free']*0.8)))):(0)); ((Math.abs(((a['new']<16)?1:0))>0.00001)?(a['new']=0):(0)); a['n']=0; a['m']=a['new']; a['dec']=((Math.abs(((a['new']>0)?1:0))>0.00001)?(0.3):(a['dec_f'])); a['new_']=((a['new_']*a['dec'])+((1-a['dec'])*a['new'])); a['q29']=a['new_']; ((Math.abs(((a['new']>0)?1:0))>0.00001)?((function(){((Math.abs(((Math.abs((mod(a['index'],5))-(3))<0.00001)?1:0))>0.00001)?((function(){a['csum']=sqrt(((pow(a['bass_att'], 2)+pow(a['mid_att'], 2))+pow(a['treb_att'], 2))); a['flim']=Math.min(Math.max(0, ((2*pow(div(rand(100),100), 2))-0.5)), 1); a['colr']=((a['colr']*0.5)+div((0.5*pow(a['bass_att'], 1)),a['csum'])); a['colb']=((a['colb']*0.5)+div((0.5*pow(a['mid_att'], 1)),a['csum'])); return a['colg']=((a['colg']*0.5)+div((0.5*pow(a['treb_att'], 1)),a['csum']));})()):(0)); return (function(){var mdparser_idx84;var mdparser_count85=0;do{mdparser_count85+=1;mdparser_idx84=(function(){a['self']=(mod(a['head_ptr'],a['obj_num'])*a['obj_size']); ((Math.abs(((a['gmegabuf'][Math.floor((a['self']+12))]<=0)?1:0))>0.00001)?((function(){((Math.abs(((Math.abs((a['style'])-(1))<0.00001)?1:0))>0.00001)?((function(){a['theta']=(1.5+((8*a['n3'])*Math.sin((div(((a['i2']*6.28)*a['n']),a['new'])+a['time'])))); return a['phi']=(Math.sin((div((a['i3']*a['n']),a['new'])*6.3))*6.3);})()):((function(){a['theta']=rand(12); return a['phi']=rand(12);})())); a['v0']=(((1+(0.1*(div(rand(100),100)-0.5)))*a['pspeed'])*(1+(((4*(1-a['n3']))*a['n2'])*Math.cos(div(((6.28*a['i1'])*a['n']),a['new']))))); ((Math.abs(((Math.abs((a['circles'])-(0))<0.00001)?1:0))>0.00001)?((function(){a['vx']=((Math.sin(a['theta'])*Math.cos(a['phi']))*a['v0']); a['vy']=((Math.sin(a['theta'])*Math.sin(a['phi']))*a['v0']); return a['vz']=(Math.cos(a['theta'])*a['v0']);})()):(0)); a['vx1']=(((a['vx']*a['reg50'])+(a['vy']*a['reg53']))+(a['vz']*a['reg56'])); a['vy1']=(((a['vx']*a['reg51'])+(a['vy']*a['reg54']))+(a['vz']*a['reg57'])); a['vz1']=(((a['vx']*a['reg52'])+(a['vy']*a['reg55']))+(a['vz']*a['reg58'])); a['vx']=a['vx1']; a['vy']=a['vy1']; a['vz']=a['vz1']; a['gmegabuf'][Math.floor(a['self'])]=a['x0']; a['gmegabuf'][Math.floor((a['self']+1))]=a['y0']; a['gmegabuf'][Math.floor((a['self']+2))]=a['z0']; a['gmegabuf'][Math.floor((a['self']+3))]=(a['vx']+a['vx0']); a['gmegabuf'][Math.floor((a['self']+4))]=(a['vy']+a['vy0']); a['gmegabuf'][Math.floor((a['self']+5))]=(a['vz']+a['vz0']); a['gmegabuf'][Math.floor((a['self']+6))]=a['flim']; a['gmegabuf'][Math.floor((a['self']+9))]=a['colr']; a['gmegabuf'][Math.floor((a['self']+10))]=a['colg']; a['gmegabuf'][Math.floor((a['self']+11))]=a['colb']; a['gmegabuf'][Math.floor((a['self']+12))]=a['dt2']; a['gmegabuf'][Math.floor((a['self']+13))]=(div(rand(100),100)+0.5); a['gmegabuf'][Math.floor((a['self']+14))]=(Math.min(a['free2'], (a['vol_att']*((Math.abs((mod(a['n'],8))-(0))<0.00001)?1:0)))*((a['gmegabuf'][Math.floor((a['self']+13))]>1)?1:0)); a['ltest']+=1; a['n']+=1; return a['m']-=1;})()):(0)); a['head_ptr']=mod((a['head_ptr']+1),a['obj_num']); return ((a['m']>0)?1:0)})()}while(Math.abs(mdparser_idx84)>0.000010&&mdparser_count85<1048576);}());})()):(0)); a['n']=0; a['free']=0; a['att0']=((a['att0']*a['dec_m'])+(((((1-a['dec_m'])*-0.05)*a['n1'])*a['n2'])*a['n3'])); ((Math.abs(((a['att0']>0)?1:0))>0.00001)?(a['att0']*=0.5):(0)); a['att1']=(-0.0005*((Math.abs((mod(a['index2'],3))-(0))<0.00001)?1:0)); for(var mdparser_idx86=0;mdparser_idx86<a['obj_num'];mdparser_idx86++){a['self']=(a['n']*a['obj_size']); a['age']=a['gmegabuf'][Math.floor((a['self']+12))]; ((Math.abs(((a['age']>0)?1:0))>0.00001)?((function(){((Math.abs(((a['age']>a['max_age'])?1:0))>0.00001)?(a['age']=0):(a['age']+=(a['dt2']+(((2*a['dt2'])*((Math.abs((a['style'])-(0))<0.00001)?1:0))*mod(a['index2'],2))))); a['new']=Math.min(a['free2'], a['gmegabuf'][Math.floor((a['self']+14))]); ((Math.abs(((a['new']>0)?1:0))>0.00001)?((function(){var mdparser_idx87;var mdparser_count88=0;do{mdparser_count88+=1;mdparser_idx87=(function(){a['self2']=((mod(a['ptr2'],a['num2'])*a['obj_size'])+a['base2']); ((Math.abs(((a['gmegabuf'][Math.floor((a['self2']+12))]<=0)?1:0))>0.00001)?((function(){a['gmegabuf'][Math.floor(a['self2'])]=a['gmegabuf'][Math.floor(a['self'])]; a['gmegabuf'][Math.floor((a['self2']+1))]=a['gmegabuf'][Math.floor((a['self']+1))]; a['gmegabuf'][Math.floor((a['self2']+2))]=a['gmegabuf'][Math.floor((a['self']+2))]; a['gmegabuf'][Math.floor((a['self2']+3))]=(a['gmegabuf'][Math.floor((a['self']+3))]+((a['pspeed']*(div(rand(100),100)-0.5))*a['n4'])); a['gmegabuf'][Math.floor((a['self2']+4))]=(a['gmegabuf'][Math.floor((a['self']+4))]+((a['pspeed']*(div(rand(100),100)-0.5))*a['n4'])); a['gmegabuf'][Math.floor((a['self2']+5))]=(a['gmegabuf'][Math.floor((a['self']+5))]+((a['pspeed']*(div(rand(100),100)-0.5))*a['n4'])); a['gmegabuf'][Math.floor((a['self2']+9))]=pow(a['gmegabuf'][Math.floor((a['self']+9))], 1.5); a['gmegabuf'][Math.floor((a['self2']+10))]=pow(a['gmegabuf'][Math.floor((a['self']+10))], 1.5); a['gmegabuf'][Math.floor((a['self2']+11))]=pow(a['gmegabuf'][Math.floor((a['self']+11))], 1.5); a['gmegabuf'][Math.floor((a['self2']+12))]=a['dt2']; a['gmegabuf'][Math.floor((a['self2']+13))]=(div(rand(100),200)+0.5); a['ltest']+=1; a['new']-=1; return a['free2']-=1;})()):(0)); a['ptr2']=mod((a['ptr2']+1),a['num2']); return ((a['new']>0)?1:0)})()}while(Math.abs(mdparser_idx87)>0.000010&&mdparser_count88<1048576);}())):(a['gmegabuf'][Math.floor((a['self']+14))]=0)); a['v2']=((pow(a['gmegabuf'][Math.floor((a['self']+3))], 2)+pow(a['gmegabuf'][Math.floor((a['self']+4))], 2))+pow(a['gmegabuf'][Math.floor((a['self']+5))], 2)); a['brake']=Math.max(0.5, (1-((a['dt']*a['cw'])*a['v2']))); a['gmegabuf'][Math.floor(a['self'])]+=(a['gmegabuf'][Math.floor((a['self']+3))]*a['dt']); a['gmegabuf'][Math.floor((a['self']+1))]+=(a['gmegabuf'][Math.floor((a['self']+4))]*a['dt']); a['gmegabuf'][Math.floor((a['self']+2))]+=(a['gmegabuf'][Math.floor((a['self']+5))]*a['dt']); a['gmegabuf'][Math.floor((a['self']+3))]*=a['brake']; a['gmegabuf'][Math.floor((a['self']+4))]*=a['brake']; a['gmegabuf'][Math.floor((a['self']+5))]*=a['brake']; a['dist']=((pow((a['gmegabuf'][Math.floor(a['self'])]-a['x0']), 2)+pow((a['gmegabuf'][Math.floor((a['self']+1))]-a['y0']), 2))+pow((a['gmegabuf'][Math.floor((a['self']+2))]-a['z0']), 2)); a['ax']=div((a['att0']*(a['gmegabuf'][Math.floor(a['self'])]-a['x0'])),a['dist']); a['ay']=div((a['att0']*(a['gmegabuf'][Math.floor((a['self']+1))]-a['y0'])),a['dist']); a['az']=div((a['att0']*(a['gmegabuf'][Math.floor((a['self']+2))]-a['z0'])),a['dist']); a['gmegabuf'][Math.floor((a['self']+3))]+=(a['ax']*a['dt']); a['gmegabuf'][Math.floor((a['self']+4))]+=(a['ay']*a['dt']); a['gmegabuf'][Math.floor((a['self']+5))]+=(a['az']*a['dt']); a['ax']=Math.atan(div(a['att1'],(a['gmegabuf'][Math.floor(a['self'])]-a['xcam']))); a['ay']=Math.atan(div(a['att1'],(a['gmegabuf'][Math.floor((a['self']+1))]-a['ycam']))); a['az']=Math.atan(div(a['att1'],(a['gmegabuf'][Math.floor((a['self']+2))]-a['zcam']))); a['gmegabuf'][Math.floor((a['self']+3))]+=(a['ax']*a['dt']); a['gmegabuf'][Math.floor((a['self']+4))]+=(a['ay']*a['dt']); a['gmegabuf'][Math.floor((a['self']+5))]+=(a['az']*a['dt']); return a['gmegabuf'][Math.floor((a['self']+4))]+=((a['g0']*a['dt'])*a['gmegabuf'][Math.floor((a['self']+13))]);})()):(a['free']+=1)); a['gmegabuf'][Math.floor((a['self']+12))]=a['age']; a['n']+=1;} a['n']=0; a['free2']=0; for(var mdparser_idx89=0;mdparser_idx89<a['num2'];mdparser_idx89++){a['self']=((a['n']*a['obj_size'])+a['base2']); a['age']=a['gmegabuf'][Math.floor((a['self']+12))]; ((Math.abs(((a['age']>0)?1:0))>0.00001)?((function(){((Math.abs(((a['age']>a['mage2'])?1:0))>0.00001)?(a['age']=0):(a['age']+=div((a['dt2']*rand(10)),5))); a['v2']=((pow(a['gmegabuf'][Math.floor((a['self']+3))], 2)+pow(a['gmegabuf'][Math.floor((a['self']+4))], 2))+pow(a['gmegabuf'][Math.floor((a['self']+5))], 2)); a['brake']=Math.max(0.1, (1-(((100*a['dt'])*a['cw'])*a['v2']))); a['gmegabuf'][Math.floor(a['self'])]+=(a['gmegabuf'][Math.floor((a['self']+3))]*a['dt']); a['gmegabuf'][Math.floor((a['self']+1))]+=(a['gmegabuf'][Math.floor((a['self']+4))]*a['dt']); a['gmegabuf'][Math.floor((a['self']+2))]+=(a['gmegabuf'][Math.floor((a['self']+5))]*a['dt']); a['gmegabuf'][Math.floor((a['self']+3))]*=a['brake']; a['gmegabuf'][Math.floor((a['self']+4))]*=a['brake']; a['gmegabuf'][Math.floor((a['self']+5))]*=a['brake']; return a['gmegabuf'][Math.floor((a['self']+4))]+=(a['g0']*a['dt']);})()):(a['free2']+=1)); a['gmegabuf'][Math.floor((a['self']+12))]=a['age']; a['n']+=1;} a['new']=Math.floor((div(a['t_free'],8)*a['vol_att'])); a['new']=Math.min(a['new'], a['t_free']); ((Math.abs(((a['new']>1)?1:0))>0.00001)?((function(){var mdparser_idx90;var mdparser_count91=0;do{mdparser_count91+=1;mdparser_idx90=(function(){a['self']=((mod(a['t_ptr'],a['t_num'])*a['obj_size'])+a['tbase']); ((Math.abs(((a['gmegabuf'][Math.floor((a['self']+12))]<=0)?1:0))>0.00001)?((function(){a['v0']=((1+(0.3*(div(rand(100),100)-0.5)))*-a['tspeed']); a['vx']=((0.1*(div(rand(10),10)-0.5))*a['v0']); a['vy']=((0.1*(div(rand(10),10)-0.5))*a['v0']); a['vz']=a['v0']; a['vx1']=(((a['vx']*a['reg50'])+(a['vy']*a['reg53']))+(a['vz']*a['reg56'])); a['vy1']=(((a['vx']*a['reg51'])+(a['vy']*a['reg54']))+(a['vz']*a['reg57'])); a['vz1']=(((a['vx']*a['reg52'])+(a['vy']*a['reg55']))+(a['vz']*a['reg58'])); a['vx']=a['vx1']; a['vy']=a['vy1']; a['vz']=a['vz1']; a['ran']=div(((-a['v0']*a['dt'])*rand(100)),100); a['gmegabuf'][Math.floor(a['self'])]=(a['x0']+(a['ran']*a['reg56'])); a['gmegabuf'][Math.floor((a['self']+1))]=(a['y0']+(a['ran']*a['reg57'])); a['gmegabuf'][Math.floor((a['self']+2))]=(a['z0']+(a['ran']*a['reg58'])); a['gmegabuf'][Math.floor((a['self']+3))]=(a['vx']+a['vx0']); a['gmegabuf'][Math.floor((a['self']+4))]=(a['vy']+a['vy0']); a['gmegabuf'][Math.floor((a['self']+5))]=(a['vz']+a['vz0']); a['gmegabuf'][Math.floor((a['self']+12))]=a['dt2']; a['gmegabuf'][Math.floor((a['self']+13))]=(0.5+div(rand(100),150)); a['ltest']+=1; return a['new']-=1;})()):(0)); a['t_ptr']=mod((a['t_ptr']+1),a['t_num']); return ((a['new']>0)?1:0)})()}while(Math.abs(mdparser_idx90)>0.000010&&mdparser_count91<1048576);}())):(0)); a['n']=0; a['t_free']=0; for(var mdparser_idx92=0;mdparser_idx92<a['t_num'];mdparser_idx92++){a['self']=((a['n']*a['obj_size'])+a['tbase']); a['age']=a['gmegabuf'][Math.floor((a['self']+12))]; a['ltest']+=1; ((Math.abs(((a['age']>0)?1:0))>0.00001)?((function(){((Math.abs(((a['age']>a['t_age'])?1:0))>0.00001)?(a['age']=0):(a['age']+=a['dt2'])); a['v2']=((pow(a['gmegabuf'][Math.floor((a['self']+3))], 2)+pow(a['gmegabuf'][Math.floor((a['self']+4))], 2))+pow(a['gmegabuf'][Math.floor((a['self']+5))], 2)); a['brake']=Math.max(0.5, (1-((a['dt']*a['cw'])*a['v2']))); a['gmegabuf'][Math.floor(a['self'])]+=(a['gmegabuf'][Math.floor((a['self']+3))]*a['dt']); a['gmegabuf'][Math.floor((a['self']+1))]+=(a['gmegabuf'][Math.floor((a['self']+4))]*a['dt']); a['gmegabuf'][Math.floor((a['self']+2))]+=(a['gmegabuf'][Math.floor((a['self']+5))]*a['dt']); a['gmegabuf'][Math.floor((a['self']+3))]*=a['brake']; a['gmegabuf'][Math.floor((a['self']+4))]*=a['brake']; a['gmegabuf'][Math.floor((a['self']+5))]*=a['brake']; a['gmegabuf'][Math.floor((a['self']+3))]+=((Math.sin((a['gmegabuf'][Math.floor((a['self']+1))]*444))*a['dt'])*0.04); a['gmegabuf'][Math.floor((a['self']+4))]+=((Math.sin((a['gmegabuf'][Math.floor((a['self']+2))]*444))*a['dt'])*0.04); a['gmegabuf'][Math.floor((a['self']+5))]+=((Math.sin((a['gmegabuf'][Math.floor((a['self']+0))]*444))*a['dt'])*0.04); return a['gmegabuf'][Math.floor((a['self']+4))]+=(a['g0']*a['dt']);})()):(a['t_free']+=1)); a['gmegabuf'][Math.floor((a['self']+12))]=a['age']; a['n']+=1;} a['ranpt']=((Math.abs(((div(rand(10),7)<a['vol_att'])?1:0))>0.00001)?((mod(((a['head_ptr']+a['obj_num'])-Math.floor(rand(div(a['obj_num'],2)))),a['obj_num'])*a['obj_size'])):(a['ranpt'])); a['point']=a['ranpt']; a['x0_']=(a['gmegabuf'][Math.floor(a['point'])]-a['reg07']); a['y0_']=(a['gmegabuf'][Math.floor((a['point']+1))]-a['reg08']); a['z0_']=(a['gmegabuf'][Math.floor((a['point']+2))]-a['reg09']); a['x1']=(((a['x0_']*a['reg30'])+(a['y0_']*a['reg31']))+(a['z0_']*a['reg32'])); a['y1']=(((a['x0_']*a['reg33'])+(a['y0_']*a['reg34']))+(a['z0_']*a['reg35'])); a['z1']=(((a['x0_']*a['reg36'])+(a['y0_']*a['reg37']))+(a['z0_']*a['reg38'])); a['q11']=(0.5+(div(a['x1'],a['z1'])*a['fac'])); a['q12']=(0.5+(div(a['y1'],a['z1'])*a['fac'])); a['age']=a['gmegabuf'][Math.floor((a['point']+12))]; a['q13']=((((((Math.abs(((a['z1']>0)?1:0))>0.00001)?(div(1,a['z1'])):(0))*((a['age']>0)?1:0))*(1-div(a['age'],a['max_age'])))*sqrt(a['treb']))*0.0008); a['q13']=Math.max(0, (a['q13']*(0.5+a['flim']))); a['x0_']=(a['x0']-a['reg07']); a['y0_']=(a['y0']-a['reg08']); a['z0_']=(a['z0']-a['reg09']); a['x1']=(((a['x0_']*a['reg30'])+(a['y0_']*a['reg31']))+(a['z0_']*a['reg32'])); a['y1']=(((a['x0_']*a['reg33'])+(a['y0_']*a['reg34']))+(a['z0_']*a['reg35'])); a['z1']=(((a['x0_']*a['reg36'])+(a['y0_']*a['reg37']))+(a['z0_']*a['reg38'])); a['q14']=(0.5+(div(a['x1'],a['z1'])*a['fac'])); a['q15']=(0.5+(div(a['y1'],a['z1'])*a['fac'])); a['q16']=((Math.abs(((a['z1']>0)?1:0))>0.00001)?(((div((div(1,a['z1'])*a['q29']),3)+20)+(40*a['vol_att']))):(0)); a['q16']=Math.max(0, div(a['q16'],4)); a['reg07']=a['xcam']; a['reg08']=a['ycam']; a['reg09']=a['zcam']; a['dxcam']=(((a['x0']-a['xcam'])*a['dt'])*a['camspeed']); a['dycam']=((((a['y0']-a['ycam'])-0.0)*a['dt'])*a['camspeed']); a['dzcam']=((((a['z0']-a['zcam'])-a['camdist'])*a['dt'])*a['camspeed']); a['xcam']+=a['dxcam']; a['ycam']+=a['dycam']; a['zcam']+=a['dzcam']; a['x1']=((((a['x0']-a['xcam'])*a['reg30'])+((a['y0']-a['ycam'])*a['reg31']))+((a['z0']-a['zcam'])*a['reg32'])); a['y1']=((((a['x0']-a['xcam'])*a['reg33'])+((a['y0']-a['ycam'])*a['reg34']))+((a['z0']-a['zcam'])*a['reg35'])); a['dist']=sqrt(((pow((a['x0']-a['xcam']), 2)+pow((a['y0']-a['ycam']), 2))+pow((a['z0']-a['zcam']), 2))); a['k1']=(div(a['dt'],Math.max(a['dist'], 0.02))*a['camlock']); a['v1']=(-a['k1']*a['y1']); a['v2']=(a['k1']*a['x1']); a['v3']=((-a['reg31']*a['k1'])*a['hlock']); a['c1']=Math.cos(a['v1']); a['c2']=Math.cos(a['v2']); a['c3']=Math.cos(a['v3']); a['s1']=Math.sin(a['v1']); a['s2']=Math.sin(a['v2']); a['s3']=Math.sin(a['v3']); a['reg40']=(a['c2']*a['c3']); a['reg41']=(a['c2']*a['s3']); a['reg42']=-a['s2']; a['reg43']=(((a['s1']*a['s2'])*a['c3'])-(a['c1']*a['s3'])); a['reg44']=(((a['s1']*a['s2'])*a['s3'])+(a['c1']*a['c3'])); a['reg45']=(a['s1']*a['c2']); a['reg46']=(((a['c1']*a['s2'])*a['c3'])+(a['s1']*a['s3'])); a['reg47']=(((a['c1']*a['s2'])*a['s3'])-(a['s1']*a['c3'])); a['reg48']=(a['c1']*a['c2']); a['q20']=(((a['reg40']*a['reg30'])+(a['reg41']*a['reg33']))+(a['reg42']*a['reg36'])); a['q21']=(((a['reg40']*a['reg31'])+(a['reg41']*a['reg34']))+(a['reg42']*a['reg37'])); a['q22']=(((a['reg40']*a['reg32'])+(a['reg41']*a['reg35']))+(a['reg42']*a['reg38'])); a['q23']=(((a['reg43']*a['reg30'])+(a['reg44']*a['reg33']))+(a['reg45']*a['reg36'])); a['q24']=(((a['reg43']*a['reg31'])+(a['reg44']*a['reg34']))+(a['reg45']*a['reg37'])); a['q25']=(((a['reg43']*a['reg32'])+(a['reg44']*a['reg35']))+(a['reg45']*a['reg38'])); a['q26']=(((a['reg46']*a['reg30'])+(a['reg47']*a['reg33']))+(a['reg48']*a['reg36'])); a['q27']=(((a['reg46']*a['reg31'])+(a['reg47']*a['reg34']))+(a['reg48']*a['reg37'])); a['q28']=(((a['reg46']*a['reg32'])+(a['reg47']*a['reg35']))+(a['reg48']*a['reg38'])); a['reg30']=a['q20']; a['reg31']=a['q21']; a['reg32']=a['q22']; a['reg33']=a['q23']; a['reg34']=a['q24']; a['reg35']=a['q25']; a['reg36']=a['q26']; a['reg37']=a['q27']; a['reg38']=a['q28']; a['q10']=(1.3-a['ycam']); a['q18']=(a['zcam']*4); a['q19']=(-a['xcam']*4); a['crot']=(a['crot']+a['v3']); a['cfwd']=(a['cfwd']+(((a['dxcam']*a['reg36'])+(a['dycam']*a['reg37']))+(a['dzcam']*a['reg38']))); a['q1']=Math.cos(a['crot']); a['q2']=Math.sin(a['crot']); a['cmovx']+=((-a['v1']*a['q1'])+(a['v2']*a['q2'])); a['cmovy']+=((a['v1']*a['q2'])+(a['v2']*a['q1'])); a['q5']=(a['cmovx']*0.1); a['q6']=(a['cmovy']*0.1); a['q7']=(a['cfwd']*8); a['q30']=a['dt2']; a['q31']=a['aspectx']; a['q32']=a['aspecty']; a['q17']=((Math.floor((a['colr']*10))+(Math.floor((a['colg']*10))*10))+(Math.floor((a['colb']*10))*100)); a['dx']=(-a['v2']*0.5); a['dy']=(a['v1']*0.5); a['rot']=a['v3']; a['zoom']=(1+(((a['dxcam']*a['reg36'])+(a['dycam']*a['reg37']))+(a['dzcam']*a['reg38']))); a['start']=Math.max(0, (a['start']-a['dt2'])); a['q3']=a['start']; ((Math.abs(((a['ltest']>2000)?1:0))>0.00001)?(a['fail']=1):(0)); a['monitor']=a['q30'];}());","pixel_eqs_str":"","init_eqs_eel":"//The camera tries to follow the head of the firework and look into its direction\n//Camera speed and rotational speed is limited, camera lags behind\n//Camera angle is forced back into horizontal position\n\n//-------------- BEGIN MAIN PARAMS ---------------\n//SPEEDS\ngSpeed = .65;   //global speed, affects all other speeds incl. particle lifetimes\nhSpeed = .03;  //firework head speed\npSpeed = .06;   //speed of primary particles\ntSpeed = hspeed*3.5;  //speed of tail particles\n\n//CAMERA\nCamDist  = .03; //distance camera tries to stay behind firework \nCamSpeed = .27;  //camera follower speed\nCamLock = 6;    //how fast does camera angle lock on firework\nHLock = .1;     //force camera angle back into horizontal view\n\n//OTHER PARAMS\nsharp = 40;    //sharpness of bass/treb triggered head direction changes\ng0 = .12;      //gravitation\ncw = 50;       //air drag\n\n//---------- END MAIN PARAMS -----------------\n\nn = 0; loop (150000,gmegabuf(n) = 0; n+=1);\nfac = .4; reg19 = fac;\n\n//SPARKS\nobj_num = 2000; reg00 = obj_num;\nobj_size = 16; reg01 = obj_size;\nmax_age = 3.8; reg02 = max_age;\nhead_ptr = 0; \nfree = 0;\n\n//SPARKS2\nnum2 = 2048; reg20 = num2;\nfree2 = 0;\nptr2 = 0;\nmage2 = 1; reg22 = mage2;\nbase2 = 100000;\n\n//TAIL\nt_num = 800; reg10 =t_num;\nt_age = 1; reg12 = t_age;\ntbase = obj_num*obj_size; reg13 = tbase;\nt_ptr = 0; \nt_free = 0;\n\n\nx0 = (rand(10)-5)*.03; y0 = (rand(10)-5)*.03; z0 = (rand(10)-5)*.03;;\nxcam = 0; ycam = .0; zcam = -0;\n//Obj Structure - Index\n//0..2: x,y,z  3..5: vx,vy,vz  6..8: fx,fy,fz\n//9..11: rgb     12: age         13: size;\n\n\n//camera coordinate system\n  c1 = cos(0); c2 = cos(0); c3 = cos(0); \n  s1 = sin(0); s2 = sin(0); s3 = sin(0);\n\n  reg30 = c2*c1;            reg31 = c2*s1;            reg32 = -s2;\n  reg33 = s3*s2*c1 - c3*s1; reg34 = s3*s2*s1 + c3*c1; reg35 = s3*c2;\n  reg36 = c3*s2*c1 + s3*s1; reg37 = c3*s2*s1 - s3*c1; reg38 = c3*c2;\n\n\n//head coordinate system\n  reg50 = c2*c1;            reg51 = c2*s1;            reg52 = -s2;\n  reg53 = s3*s2*c1 - c3*s1; reg54 = s3*s2*s1 + c3*c1; reg55 = s3*c2;\n  reg56 = c3*s2*c1 + s3*s1; reg57 = c3*s2*s1 - s3*c1; reg58 = c3*c2;\n\ntmp = rand(12);\ncolr = 1-rand(100)/300; \ncolg = 1-rand(100)/300; \ncolb = 1-rand(100)/300; \n\nposx = rand(1000)/100; posz = rand(1000)/100;\n\nn1= rand(10)/20; n2 = rand(10)/20; n3 = rand(10)/20; n4 = rand(10)/20;\ni1= rand(10)/20; i2 = rand(10)/20; i3 = rand(10)/20; i4 = rand(10)/20;\n\nindex2 = int(rand(32));\nstart = .9;\n//-----------------------------------------","frame_eqs_eel":"dt = gSpeed/fps; dt2 = dt ; \ndec_s = 1-.015*30/fps; dec_m = pow(.95, 30/fps); dec_f = pow(.85, 30/fps);\nvol_att = (bass + mid + treb)/3;\navg = avg*dec_s + (1-dec_s)*vol_att*(1.5-.2/cal);\n\nis_beat = above(vol_att, 1.25*peak) * above (time, t0+.3);\nt0 = if(is_beat,time,t0);\npeak = peak*dec_m  + (1-dec_m)*vol_att;\nindex = (index + is_beat) %16;\nindex2 = (index2 + is_beat*bnot(index))%16;\n\n//HEAD MOVEMENT x0,y0,z0 based on z-move in HEAD Coords\nright = pow(bass_att-avg,1) * (bass_att > avg) *sharp*n1*sin(time*3)/cal; \nup =  pow(treb_att-avg,1) * (treb_att > avg) * sharp*n2/cal; \n\ncal = max(.2,cal*dec_s + (1-dec_s)*sqrt(up*up+right*right)/4);\n\nif ((index%6==0)*is_beat,\n  n1 = rand(100)/100-.5; n2 = rand(100)/100-.5; n3 = rand(100)/100-.5; n4 = pow(rand(100)/70,2)+.05;\n  i1 = 1+int(rand(6)); i2 = 1+int(rand(6)); i3 = 1+int(rand(6)); ,0);\n  \nsp0 = (.5+sqrt(vol_att*4))*hSpeed;\ndec = if(sp0 > speed,.5, dec_m); //checken\nspeed =  speed*dec + (1-dec)*sp0;\n\n//HEAD COORD SYS\nc1 = cos(up*dt); c2 = cos(right*dt); c3 = 1; \ns1 = sin(up*dt); s2 = sin(right*dt); s3 = 0;\nreg40 = c2*c3;            reg41 = c2*s3;            reg42 = -s2;\nreg43 = s1*s2*c3 - c1*s3; reg44 = s1*s2*s3 + c1*c3; reg45 = s1*c2;\nreg46 = c1*s2*c3 + s1*s3; reg47 = c1*s2*s3 - s1*c3; reg48 = c1*c2;\n\nq20 = reg40*reg50 + reg41*reg53 + reg42*reg56;\nq21 = reg40*reg51 + reg41*reg54 + reg42*reg57;\nq22 = reg40*reg52 + reg41*reg55 + reg42*reg58;\nq23 = reg43*reg50 + reg44*reg53 + reg45*reg56;\nq24 = reg43*reg51 + reg44*reg54 + reg45*reg57;\nq25 = reg43*reg52 + reg44*reg55 + reg45*reg58;\nq26 = reg46*reg50 + reg47*reg53 + reg48*reg56;\nq27 = reg46*reg51 + reg47*reg54 + reg48*reg57;\nq28 = reg46*reg52 + reg47*reg55 + reg48*reg58;\n\nreg50 = q20; reg51 = q21; reg52 = q22;\nreg53 = q23; reg54 = q24; reg55 = q25;\nreg56 = q26; reg57 = q27; reg58 = q28;\nvx0 = reg56*speed;\nvy0 = reg57*speed;\nvz0 = reg58*speed;\nx0 = x0 + vx0*dt ;          reg04 = x0; \ny0 = max(-.5,min(0.5,y0 + vy0*dt)) ; reg05 = y0; \nz0 = z0 + vz0*dt ;          reg06 = z0; \n\nltest = 0;\nstyle = n1 > 0; \ncircles = (index2>=12); \n//SPARK QUEUE - insert new objects\nif (style ==0, new = max(0,min(1800*dt*(mid>1.2),free)),0);\nif (style ==1, new = max(0,min(200*vol_att*(vol_att*200 > 50+obj_num-free),free*.8)),0);\nif (new < 16, new = 0, 0);\nn = 0; m = new; \ndec = if (new > 0,0.3,dec_f); \nnew_ = new_*dec + (1-dec)*new;\nq29 = new_;\nif (new > 0,\n  if (index%5==3,\n    csum = sqrt(pow(bass_att,2) + pow(mid_att,2) + pow(treb_att,2)) ;\n    flim = min(max(0,2*pow(rand(100)/100,2)-.5),1);\n    colr = colr*.5 + .5* pow(bass_att,1)/csum;\n    colb = colb*.5 + .5* pow(mid_att,1)/csum;\n    colg = colg*.5 + .5* pow(treb_att,1)/csum;,0);\n  while (exec2 (\n    self = (head_ptr%obj_num)*obj_size;\n    if (gmegabuf(self+12) <= 0,\n      // for rad.sym use theta = 1.5, phi = 0..6\n      if (style==1,theta = 1.5 + 8*n3*sin(i2*6.28*n/new+time); phi = sin(i3*n/new*6.3)*6.3,\n                         theta = rand(12); phi = rand(12));\n      v0 = (1 + .1*(rand(100)/100-.5))*pSpeed * (1+4*(1-n3)*n2*cos(6.28*i1*n/new)); \n      if (circles==0,\n        vx = sin(theta)*cos(phi)*v0;\n        vy = sin(theta)*sin(phi)*v0;\n        vz = cos(theta)*v0;,0);\n      vx1 = vx*reg50 + vy*reg53+ vz*reg56;\n      vy1 = vx*reg51 + vy*reg54+ vz*reg57;\n      vz1 = vx*reg52 + vy*reg55+ vz*reg58;\n      vx = vx1; vy = vy1; vz = vz1;\n      gmegabuf(self)   = x0;\n      gmegabuf(self+1) = y0;\n      gmegabuf(self+2) = z0;\n      gmegabuf(self+3) = vx+vx0;\n      gmegabuf(self+4) = vy+vy0;\n      gmegabuf(self+5) = vz+vz0;\n      gmegabuf(self+6) = flim;\n\n      gmegabuf(self+9) = colr;\n      gmegabuf(self+10) = colg;\n      gmegabuf(self+11) = colb;\n      gmegabuf(self+12) = dt2;\n      gmegabuf(self+13) = rand(100)/100+.5;//size\n      gmegabuf(self+14) = min(free2,vol_att* (n%8==0)) * (gmegabuf(self+13)>1);\n      ltest += 1;\n      n += 1; m -= 1;\n   ,0;);\n   head_ptr = (head_ptr+1)%obj_num;, m > 0))\n,0);\n\n//SPARK QUEUE - calc movement\nn = 0; free = 0;       \natt0 = att0*dec_m + (1-dec_m)*-.05 * n1*n2*n3; \nif (att0>0, att0*=.5,0);\natt1 = -0.0005 * (index2%3==0);\n\nloop (obj_num,\n  self = n*obj_size;\n  age = gmegabuf(self+12);\n  if (age > 0, \n    if (age > max_age, age = 0, age += dt2 + 2*dt2*(style==0)*(index2%2));\n      new = min (free2, gmegabuf(self+14));\n      if (new > 0,\n        while (exec2(  \n          self2 = (ptr2%num2)*obj_size+base2;\n          if (gmegabuf(self2+12) <= 0,\n            gmegabuf(self2)   = gmegabuf(self);\n            gmegabuf(self2+1) = gmegabuf(self+1);\n            gmegabuf(self2+2) = gmegabuf(self+2);\n            gmegabuf(self2+3) = gmegabuf(self+3)+pSpeed*(rand(100)/100-.5)*n4;\n            gmegabuf(self2+4) = gmegabuf(self+4)+pSpeed*(rand(100)/100-.5)*n4;\n            gmegabuf(self2+5) = gmegabuf(self+5)+pSpeed*(rand(100)/100-.5)*n4;\n            gmegabuf(self2+9) = pow(gmegabuf(self+9),1.5);\n            gmegabuf(self2+10) =pow(gmegabuf(self+10),1.5);\n            gmegabuf(self2+11) =pow(gmegabuf(self+11),1.5);\n            gmegabuf(self2+12) = dt2;\n            gmegabuf(self2+13) = rand(100)/200+.5;//size\n             ltest += 1;\n            new -=1; free2 -= 1;\n          ,0;);\n        ptr2 = (ptr2 + 1)%num2;, new > 0));\n      ,gmegabuf(self+14) = 0);      //#nochmal pruefen !\n      v2 = pow(gmegabuf(self+3),2)+pow(gmegabuf(self+4),2)+pow(gmegabuf(self+5),2);\n      brake = max(0.5,1-dt*cw*v2);\n      gmegabuf(self)   += gmegabuf(self+3)*dt;\n      gmegabuf(self+1) += gmegabuf(self+4)*dt;\n      gmegabuf(self+2) += gmegabuf(self+5)*dt;\n      gmegabuf(self+3) *= brake;\n      gmegabuf(self+4) *= brake;\n      gmegabuf(self+5) *= brake;\n    //head attraction\n      dist = (pow(gmegabuf(self)-x0,2) + pow(gmegabuf(self+1)-y0,2) + pow(gmegabuf(self+2)-z0,2));\n      ax = (att0*(gmegabuf(self)-x0)/dist);\n      ay = (att0*(gmegabuf(self+1)-y0)/dist);\n      az = (att0*(gmegabuf(self+2)-z0)/dist);\n      gmegabuf(self+3) += ax*dt;\n      gmegabuf(self+4) += ay*dt;\n      gmegabuf(self+5) += az*dt;\n\n    //cam induced turbulence\n      ax = atan(att1/(gmegabuf(self)-xcam));\n      ay = atan(att1/(gmegabuf(self+1)-ycam));\n      az = atan(att1/(gmegabuf(self+2)-zcam));\n      gmegabuf(self+3) += ax*dt;\n      gmegabuf(self+4) += ay*dt;\n      gmegabuf(self+5) += az*dt;\n\n    //Gravitation\n      gmegabuf(self+4) += g0*dt * gmegabuf(self+13); \n  ,free += 1); //otherwise\n  gmegabuf(self+12) = age;\n  n += 1;);\n\n//2nd SPARK QUEUE - movement\nn = 0; free2 = 0;\nloop (num2,\n  self = n*obj_size + base2;\n  age = gmegabuf(self+12);\n  if (age > 0, \n    if (age > mage2, age = 0, age +=dt2*rand(10)/5);\n    v2 = pow(gmegabuf(self+3),2)+pow(gmegabuf(self+4),2)+pow(gmegabuf(self+5),2);\n    brake = max(0.1,1-100*dt*cw*v2);\n    gmegabuf(self)   += gmegabuf(self+3)*dt;\n    gmegabuf(self+1) += gmegabuf(self+4)*dt;\n    gmegabuf(self+2) += gmegabuf(self+5)*dt;\n    gmegabuf(self+3) *= brake;\n    gmegabuf(self+4) *= brake;\n    gmegabuf(self+5) *= brake;\n    gmegabuf(self+4) += g0*dt; //Gravitation\n  ,free2 += 1);\n  gmegabuf(self+12) = age;\n  n += 1;);\n\n//TAIL\nnew = int(t_free/8*vol_att); //# vol ?\nnew = min (new, t_free);\nif (new > 1,\n  while (exec2 (\n    self = (t_ptr%t_num)*obj_size+tbase;\n    if (gmegabuf(self+12) <= 0,\n      v0 = (1 + .3*(rand(100)/100-.5))*-tSpeed; \n      vx = .1*(rand(10)/10-.5)*v0;\n      vy = .1*(rand(10)/10-.5)*v0;\n      vz = v0;\n      vx1 = vx*reg50 + vy*reg53+ vz*reg56;\n      vy1 = vx*reg51 + vy*reg54+ vz*reg57;\n      vz1 = vx*reg52 + vy*reg55+ vz*reg58;\n      vx = vx1; vy = vy1; vz = vz1; ran = -v0*dt*rand(100)/100;\n      gmegabuf(self)   = x0 + ran*reg56;\n      gmegabuf(self+1) = y0 + ran*reg57;\n      gmegabuf(self+2) = z0 + ran*reg58;\n      gmegabuf(self+3) = vx+vx0;\n      gmegabuf(self+4) = vy+vy0;\n      gmegabuf(self+5) = vz+vz0;\n      gmegabuf(self+12) = dt2;\n      gmegabuf(self+13) = .5 + rand(100)/150;//size\n      ltest += 1;\n      new -= 1;\n   ,0;);\n  t_ptr = (t_ptr+1)%t_num;, new > 0))\n,0);\n\n//TAIL QUEUE - calc movement\nn = 0; t_free = 0;\nloop (t_num,\n  self = n*obj_size + tbase;\n  age = gmegabuf(self+12);\n  ltest += 1;\n  if (age > 0, \n    if (age > t_age, age = 0, age +=dt2);\n    v2 = pow(gmegabuf(self+3),2)+pow(gmegabuf(self+4),2)+pow(gmegabuf(self+5),2);\n    brake = max(0.5,1-dt*cw*v2); \n    gmegabuf(self)   += gmegabuf(self+3)*dt;\n    gmegabuf(self+1) += gmegabuf(self+4)*dt;\n    gmegabuf(self+2) += gmegabuf(self+5)*dt;\n    gmegabuf(self+3) *= brake;\n    gmegabuf(self+4) *= brake;\n    gmegabuf(self+5) *= brake;\n    gmegabuf(self+3) += sin(gmegabuf(self+1)*444)*dt*.04;\n    gmegabuf(self+4) += sin(gmegabuf(self+2)*444)*dt*.04;\n    gmegabuf(self+5) += sin(gmegabuf(self+0)*444)*dt*.04;\n\n    gmegabuf(self+4) += g0*dt; //Gravitation\n  ,t_free += 1); //otherwise\n  gmegabuf(self+12) = age;\n  n += 1;\n);\n\n//SPARK and HEAD COORD for use in comp shader\n\nranpt = if (rand(10)/7<vol_att,((head_ptr+obj_num-int(rand(obj_num/2)))%obj_num)*obj_size, ranpt);\npoint = ranpt;\nx0_ = gmegabuf(point)-reg07; y0_ = gmegabuf(point+1)-reg08; z0_ = gmegabuf(point+2)-reg09;\nx1 = x0_*reg30 + y0_*reg31 + z0_*reg32;\ny1 = x0_*reg33 + y0_*reg34 + z0_*reg35;\nz1 = x0_*reg36 + y0_*reg37 + z0_*reg38;\nq11 = .5 + x1/z1*fac;\nq12 = .5 + y1/z1*fac;\nage = gmegabuf(point+12);\nq13 = if (z1>0,1/z1,0) * (age > 0)*(1-age/max_age) * sqrt(treb)*.0008;\nq13 = max(0,q13*(.5+flim));\n\nx0_ = x0-reg07; y0_ = y0-reg08; z0_ = z0-reg09;\nx1 = x0_*reg30 + y0_*reg31 + z0_*reg32;\ny1 = x0_*reg33 + y0_*reg34 + z0_*reg35;\nz1 = x0_*reg36 + y0_*reg37 + z0_*reg38;\nq14 = .5 + x1/z1*fac;\nq15 = .5 + y1/z1*fac;\nq16 = if (z1>0, 1/z1* q29/3+20 + 40*vol_att,0) ;\nq16 = max(0,q16/4) ;\n\n\n//FOLLOW WITH CAMERA\nreg07 = xcam; reg08 = ycam; reg09 = zcam;\ndxcam = (x0-xcam)*dt*CamSpeed; dycam = (y0-ycam-.0)*dt*CamSpeed; dzcam = (z0-zcam-CamDist)*dt*CamSpeed; \nxcam += dxcam; ycam += dycam; zcam += dzcam; \n\n//ROTATE VIEPOINT\nx1 = (x0-XCam)*reg30 + (y0-yCam) *reg31 + (z0-zCam)*reg32;\ny1 = (x0-XCam)*reg33 + (y0-YCam) *reg34 + (z0-zCam)*reg35;\ndist = sqrt(pow(x0-xcam,2) + pow(y0-ycam,2) + pow(z0-zcam,2));\nk1 = dt/max(dist,.02)*CamLock;\nv1 =  -k1*(y1); v2 = k1*(x1); v3 = -reg31*k1*HLock;\n\nc1 = cos(v1); c2 = cos(v2); c3 = cos(v3); \ns1 = sin(v1); s2 = sin(v2); s3 = sin(v3);\nreg40 = c2*c3; reg41 = c2*s3; reg42 = -s2;\nreg43 = s1*s2*c3 - c1*s3; reg44 = s1*s2*s3 + c1*c3; reg45 = s1*c2;\nreg46 = c1*s2*c3 + s1*s3; reg47 = c1*s2*s3 - s1*c3; reg48 = c1*c2;\n\nq20 = reg40*reg30 + reg41*reg33 + reg42*reg36;\nq21 = reg40*reg31 + reg41*reg34 + reg42*reg37;\nq22 = reg40*reg32 + reg41*reg35 + reg42*reg38;\nq23 = reg43*reg30 + reg44*reg33 + reg45*reg36;\nq24 = reg43*reg31 + reg44*reg34 + reg45*reg37;\nq25 = reg43*reg32 + reg44*reg35 + reg45*reg38;\nq26 = reg46*reg30 + reg47*reg33 + reg48*reg36;\nq27 = reg46*reg31 + reg47*reg34 + reg48*reg37;\nq28 = reg46*reg32 + reg47*reg35 + reg48*reg38;\nreg30 =q20; reg31 =q21; reg32 =q22; \nreg33 =q23; reg34 =q24; reg35 =q25;\nreg36 =q26; reg37 =q27; reg38 =q28;\n\n//Fake altitude\nq10 = (1.3-ycam);\n\n//TEXTURE GND MOVEMENT\nq18 = zcam*4; \nq19 = -xcam*4;\n\n//CLOUDS MOVEMENT\ncrot = crot + v3;\ncfwd = cfwd + (dxcam*reg36 + dycam*reg37 + dzcam*reg38);\n\nq1 = cos(crot);q2 = sin(crot);\ncmovx += -v1 * q1 + v2 * q2;\ncmovy +=  v1 * q2 + v2 * q1;\nq5 = cmovx*.1;\nq6 = cmovy*.1;\nq7 = cfwd*8;\n\nq30 = dt2;\nq31 = aspectx;\nq32 = aspecty;\n\nq17 = int(colr*10) + int(colg*10)*10 + int(colb*10)*100;\ndx = -v2*.5; dy = v1*.5;\nrot = v3;\nzoom = 1+(dxcam*reg36 + dycam*reg37 + dzcam*reg38);\n\nstart = max(0,start-dt2);\nq3 = start;\nif (ltest > 2000, fail = 1, 0);\nmonitor = q30;;\n\n\n//frei: q4, q8, q9","pixel_eqs_eel":"","warp":"#define sat saturate\n\nshader_body\n{\n\nuv = 0.5 + (1.0 - abs( fract( uv * 0.5 ) * 2 - 1.0 )-.5); // Eo.S. mirror code\n\nret = mix(texture(sampler_main, uv).xyz, ((texture(sampler_blur1, uv).xyz * scale1) + bias1),0.2);\nuv = (uv+uv_orig)/2;\n//ret += mix(texture(sampler_main, uv).xyz, ((texture(sampler_blur1, uv).xyz * scale1) + bias1),0.1);\n\nret = ret * 0. - 0.004;\n}\n","comp":"#define sat saturate\n#define sampler_test sampler_moss1\nuniform sampler2D sampler_pw_noise_lq;\nuniform sampler2D sampler_test;\nfloat inten, z, tmp, lprof, gnd, ncloud;\nvec2 dz, uv1,uv2, uv3, uv4;\nvec3 back, back2, sky, ret1, ret2, rs, rs1, cloud, fcol, forest;\nconst vec3 t = vec3(q20,q23,q26);\nconst vec3 s = vec3(q22,q25,q28);\nconst vec3 ts = cross(t,s);\nconst vec2 movxz = vec2(q18,q19);\nconst vec3 col = pow(vec3((q17%10.0)/10,((q17/10.0)%10)/10.0,int(q17/100.0)/10.0),.8);\nconst float hlim = 9;\nvec3 screen;\n\nvec3 lavcol (float t) { return pow(.5,2*t*slow_roam_cos);}\n\nfloat aTan2(float y, float x) {float angle;\t float abs_y = abs(y);\nif (x >= 0) {float r = (x - abs_y) / (x + abs_y); angle = 1-r;} \nelse {float r = (x + abs_y) / (abs_y - x); angle = 3-r; }\t\nangle = angle * .25;\nreturn y < 0 ? -angle : angle;}\n\nvec3 project  (float dist) {float z; \n  z = dist/(screen * ts); z = clamp(z,-hlim,hlim);\n  return vec3(((cross(ts,screen) * float2x3(t,s))*z+movxz),-z);}\n\nfloat noise4 (vec2 uvi) { float n1,n2,zv; zv = 0.008*time;\n  n1 = lum(texture(sampler_noise_hq, (uvi)).xyz);\n  n2 = lum(texture(sampler_noise_hq, (uvi*2+zv)).xyz);\n  return n1 + n2/2 ;}\n\nshader_body {\nuv1 = (uv-.5)*aspect.xy+.5;\nscreen = vec3 ((uv-vec2(.5,.5+.0*pow((uv.x-.5),2)))*aspect.xy,.6);\n\n//CLOUDS\nuv2 = (mat2(q1,q2,-q2,q1) * uv1*vec2(1,1));\nfloat anz = 3.0; float t_rel = q7;\ncloud = 0;\nfor (int n=1;n<=anz;n++) {\n    z = 1-fract(1.0*n/anz-1.0*fract(-t_rel/anz)); \n    inten =  (1-z)*z*2;\n    uv2 = z*uv2*.2 + vec2(q6,q5); //?\n    tmp = sat(lum(texture (sampler_noise_hq,uv2 +.01*noise4(uv2*4)).xyz-.6));\n    cloud = cloud + tmp*inten;}\nncloud = 1-cloud;\nfcol = texture(sampler_test,(uv2)*.2).xyz*1.6;\ncloud *= (.2+col);\n\n//SKY AND GROUND\nrs = project (q10); vec3 rs0 = rs;\nvec3 noise = texture (sampler_noise_hq,rs.xy*.1).xyz;\ngnd = .3*(noise.z-.5)/rs.z;\n\nforest = 0;\nfor (int m = 1; m <= 2; m++)\n{ rs = project(q10+gnd);\n  rs.xy += .015*(texture (sampler_noise_hq,vec2(rs.xy/2+time*.01)).xyz-.5);; //wind\n  rs1 = rs;\n  rs1.xy = 0.5 + (1.0 - abs( fract( rs.xy * 0.5 ) * 2 - 1.0 )-.5); // Eo.S. mirror code \n  back = texture (sampler_test,rs1.xy).xyz;;\n  lprof =  back.g;\n  tmp =  1-(clamp(1.8*lprof-.3*(2-m), 0.0, 1.0)); \n  forest += back * clamp(lprof*1, 0.0, 1.0)*.25 ;\n  gnd += tmp/pow(rs.z,2)*.3; \n}\nforest *= 1-noise.x+lprof;\nforest += (.2/length(abs(noise.xy-.2-forest.g/2)))/rs.z * (.5+slow_roam_sin)/4 ;\nback = forest/pow(rs.z,1) * (rs.z>0) * (rs.z < hlim);\n\nfloat k1 = clamp(1-10/abs(pow(rs.z,1.8)), 0.0, 1.0);\nback = mix(back,.12*lavcol(k1), k1) ;;\n\nret1 = mix(texture(sampler_main,uv).xyz,2*((texture(sampler_blur1, uv).xyz * scale1) + bias1),.0) *3 * ncloud;\nret2 = (((texture(sampler_blur2, uv).xyz * scale2) + bias2) + ((texture(sampler_blur3, uv).xyz * scale3) + bias3))*2.0;\nret1 = mix (ret1, ret2, 2*cloud);;\nret = back*ncloud + ret1 + cloud/3;\n\n\nuv2 = uv1-vec2(q11,q12);\nfloat flash = q13/(length(uv2));\nflash *= flash/(abs(fract(q12*32+int(1+treb_att)*aTan2(uv2.x,uv2.y))-.5)+.14);\n\nuv2 = uv1-vec2(q14,q15);\nfloat head = pow(.0001/(length(uv2)),.8)*q16;\nret += pow(head+flash,ncloud)*col;\n\nret += ((texture(sampler_blur3, (uv-.5)/2+.5).xyz * scale3) + bias3)/pow(rs.z,2)*(rs.z>0)*lprof*2;\n\n\n}\n\n//-------------------------------------------\n//Written by martin\n","warp_hlsl":"#define sat saturate\n\nshader_body\n{\n\nuv = 0.5 + (1.0 - abs( frac( uv * 0.5 ) * 2 - 1.0 )-.5); // Eo.S. mirror code\n\nret = lerp(GetPixel(uv), GetBlur1(uv),0.2);\nuv = (uv+uv_orig)/2;\n//ret += lerp(GetPixel(uv), GetBlur1(uv),0.1);\n\nret = ret * 0. - 0.004;\n}\n","comp_hlsl":"#define sat saturate\n#define sampler_test sampler_moss1\nsampler sampler_pw_noise_lq;\nsampler sampler_test;\nfloat inten, z, tmp, lprof, gnd, ncloud;\nfloat2 dz, uv1,uv2, uv3, uv4;\nfloat3 back, back2, sky, ret1, ret2, rs, rs1, cloud, fcol, forest;\nstatic const float3 t = float3(q20,q23,q26);\nstatic const float3 s = float3(q22,q25,q28);\nstatic const float3 ts = cross(t,s);\nstatic const float2 movxz = float2(q18,q19);\nstatic const float3 col = pow(float3((q17%10.0)/10,((q17/10.0)%10)/10.0,int(q17/100.0)/10.0),.8);\nstatic const float hlim = 9;\nfloat3 screen;\n\nfloat3 lavcol (float t) { return pow(.5,2*t*slow_roam_cos);}\n\nfloat aTan2(float y, float x) {float angle;\t float abs_y = abs(y);\nif (x >= 0) {float r = (x - abs_y) / (x + abs_y); angle = 1-r;} \nelse {float r = (x + abs_y) / (abs_y - x); angle = 3-r; }\t\nangle = angle * .25;\nreturn y < 0 ? -angle : angle;}\n\nfloat3 project  (float dist) {float z; \n  z = dist/mul(ts,screen); z = clamp(z,-hlim,hlim);\n  return float3((mul(float2x3(t,s),cross(ts,screen))*z+movxz),-z);}\n\nfloat noise4 (float2 uvi) { float n1,n2,zv; zv = 0.008*time;\n  n1 = lum(tex2D(sampler_noise_hq, (uvi)));\n  n2 = lum(tex2D(sampler_noise_hq, (uvi*2+zv)));\n  return n1 + n2/2 ;}\n\nshader_body {\nuv1 = (uv-.5)*aspect.xy+.5;\nscreen = float3 ((uv-float2(.5,.5+.0*pow((uv.x-.5),2)))*aspect.xy,.6);\n\n//CLOUDS\nuv2 = mul(uv1*float2(1,1),float2x2(q1,q2,-q2,q1));\nfloat anz = 3.0; float t_rel = q7;\ncloud = 0;\nfor (int n=1;n<=anz;n++) {\n    z = 1-frac(1.0*n/anz-1.0*frac(-t_rel/anz)); \n    inten =  (1-z)*z*2;\n    uv2 = z*uv2*.2 + float2(q6,q5); //?\n    tmp = sat(lum(tex2D (sampler_noise_hq,uv2 +.01*noise4(uv2*4))-.6));\n    cloud = cloud + tmp*inten;}\nncloud = 1-cloud;\nfcol = tex2D(sampler_test,(uv2)*.2)*1.6;\ncloud *= (.2+col);\n\n//SKY AND GROUND\nrs = project (q10); float3 rs0 = rs;\nfloat3 noise = tex2D (sampler_noise_hq,rs.xy*.1);\ngnd = .3*(noise.z-.5)/rs.z;\n\nforest = 0;\nfor (int m = 1; m <= 2; m++)\n{ rs = project(q10+gnd);\n  rs.xy += .015*(tex2D (sampler_noise_hq,float2(rs.xy/2+time*.01))-.5);; //wind\n  rs1 = rs;\n  rs1.xy = 0.5 + (1.0 - abs( frac( rs.xy * 0.5 ) * 2 - 1.0 )-.5); // Eo.S. mirror code \n  back = tex2D (sampler_test,rs1.xy);;\n  lprof =  back.g;\n  tmp =  1-(saturate(1.8*lprof-.3*(2-m))); \n  forest += back * saturate(lprof*1)*.25 ;\n  gnd += tmp/pow(rs.z,2)*.3; \n}\nforest *= 1-noise.x+lprof;\nforest += (.2/length(abs(noise.xy-.2-forest.g/2)))/rs.z * (.5+slow_roam_sin)/4 ;\nback = forest/pow(rs.z,1) * (rs.z>0) * (rs.z < hlim);\n\nfloat k1 = saturate(1-10/abs(pow(rs.z,1.8)));\nback = lerp(back,.12*lavcol(k1), k1) ;;\n\nret1 = lerp(tex2D(sampler_main,uv),2*GetBlur1(uv),.0) *3 * ncloud;\nret2 = (GetBlur2(uv) + GetBlur3(uv))*2.0;\nret1 = lerp (ret1, ret2, 2*cloud);;\nret = back*ncloud + ret1 + cloud/3;\n\n\nuv2 = uv1-float2(q11,q12);\nfloat flash = q13/(length(uv2));\nflash *= flash/(abs(frac(q12*32+int(1+treb_att)*aTan2(uv2.x,uv2.y))-.5)+.14);\n\nuv2 = uv1-float2(q14,q15);\nfloat head = pow(.0001/(length(uv2)),.8)*q16;\nret += pow(head+flash,ncloud)*col;\n\nret += GetBlur3((uv-.5)/2+.5)/pow(rs.z,2)*(rs.z>0)*lprof*2;\n\n\n}\n\n//-------------------------------------------\n//Written by martin\n"}